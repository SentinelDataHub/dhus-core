/*
 * Data Hub Service (DHuS) - For Space data distribution.
 * Copyright (C) 2017,2018 GAEL Systems
 *
 * This file is part of DHuS software sources.
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as
 * published by the Free Software Foundation, either version 3 of the
 * License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program. If not, see <http://www.gnu.org/licenses/>.
 */
package fr.gael.dhus.util;

import com.esri.core.geometry.Geometry;
import com.esri.core.geometry.OperatorImportFromWkt;
import com.esri.core.geometry.OperatorSimplifyOGC;
import com.esri.core.geometry.Polygon;
import com.esri.core.geometry.Polyline;
import com.esri.core.geometry.SpatialReference;
import com.esri.core.geometry.WktImportFlags;

import com.spatial4j.core.context.jts.JtsSpatialContext;
import com.spatial4j.core.context.jts.JtsSpatialContextFactory;
import com.spatial4j.core.io.WKTReader;
import com.spatial4j.core.io.jts.JtsWKTReader;
import com.spatial4j.core.shape.Shape;
import com.spatial4j.core.shape.ShapeCollection;

import java.io.IOException;

import org.apache.logging.log4j.LogManager;
import org.apache.logging.log4j.Logger;

import org.testng.Assert;
import org.testng.annotations.Test;

/**
 * Created by fmarino on 28/02/2017.
 */
public class TestFootprint
{
   private static final Logger LOGGER = LogManager.getLogger();

   // static copy to avoid dependency on sentinel 3 addon
   private static String processPoints(String points, String pattern,
         String coordSeparator, String pointSeparator)
   {
      String[] pointsArray = points.split(" ");
      String coords = "";
      for (int i = 0; i < pointsArray.length; i = i + 2)
      {
         coords += String.format(pattern, pointsArray[i], pointsArray[i + 1],
               coordSeparator, ((i != pointsArray.length - 2) ? pointSeparator : ""));
      }
      return coords;
   }

   private static String points2JTS(String pointsString, String type)
   {
      switch (type.trim().toLowerCase())
      {
         default:
         case "polygon":
            return "POLYGON ((" + processPoints(pointsString, "%2$s%3$s%1$s%4$s", " ", ",") + "))";
         case "linestring":
            return "LINESTRING (" + processPoints(pointsString, "%2$s%3$s%1$s%4$s", " ", ",") + ")";
      }

   }

   @Test
   public void testEfrTip()
   {
      String footprint = "-41.261 179.802 -41.4974 -179.434 -41.7278 -178.664 -41.9521 -177.891 -42.1734 -177.106 -42.3873 -176.322 -42.5972 -175.528 -42.8 -174.733 -42.9984 -173.93 -43.191 -173.123 -43.3753 -172.307 -43.5566 -171.489 -43.7293 -170.667 -43.8997 -169.84 -44.0624 -169.01 -44.2219 -168.174 -44.3712 -167.332 -44.5156 -166.488 -44.6533 -165.641 -44.7857 -164.788 -42.1628 -164.031 -39.5313 -163.308 -36.8959 -162.617 -34.2578 -161.95 -34.1295 -162.684 -33.9971 -163.416 -33.8607 -164.145 -33.7214 -164.873 -33.5738 -165.596 -33.4242 -166.319 -33.2695 -167.038 -33.1141 -167.755 -32.9518 -168.469 -32.7889 -169.182 -32.6184 -169.892 -32.4436 -170.601 -32.2669 -171.301 -32.0845 -172.004 -31.8982 -172.704 -31.709 -173.398 -31.5147 -174.093 -31.3175 -174.783 -31.1167 -175.465 -33.6749 -176.524 -36.2203 -177.659 -38.7514 -178.88 -41.261 179.802";
      footprintStub(footprint, "olci tip");
   }

   @Test
   public void testSr1()
   {
      String footprint = "81.4134 -57.3581 81.3129 -69.4546 80.856 -80.8174 80.0918 -90.7925 79.0846 -99.1727 77.8949 -106.065 76.5711 -111.704 75.1487 -116.338 73.6536 -120.184 72.1037 -123.413 70.512 -126.157 68.888 -128.516 67.2384 -130.569 65.5682 -132.373 63.8814 -133.974 62.1809 -135.407 60.4688 -136.702 58.7472 -137.879 57.0172 -138.957 55.2802 -139.95 53.537 -140.871 51.7884 -141.73 50.035 -142.534 48.2774 -143.29 46.516 -144.004 44.7512 -144.682 42.9833 -145.327 41.2127 -145.943 39.4395 -146.534 37.6639 -147.102 35.8863 -147.649 34.1067 -148.178 32.3253 -148.69 30.5423 -149.188 28.7578 -149.672 26.9719 -150.144 25.1847 -150.606 23.3964 -151.058 21.6071 -151.501 19.8168 -151.937 18.0257 -152.366 16.2339 -152.789 14.4414 -153.206 12.6483 -153.619 10.8548 -154.028 9.06093 -154.434 7.26674 -154.836 5.47235 -155.237 3.67783 -155.636 1.88327 -156.034 0.0887536 -156.431 -1.70563 -156.829 -3.4998 -157.226 -5.29368 -157.625 -7.08718 -158.025 -8.88021 -158.428 -10.6727 -158.833 -12.4646 -159.241 -14.2557 -159.653 -16.046 -160.07 -17.8355 -160.492 -19.6239 -160.92 -21.4113 -161.354 -23.1976 -161.796 -24.9825 -162.247 -26.7661 -162.706 -28.5482 -163.177 -30.3288 -163.659 -32.1076 -164.154 -33.8846 -164.664 -35.6596 -165.189 -37.4325 -165.733 -39.2031 -166.297 -40.9713 -166.883 -42.7367 -167.494 -44.4992 -168.133 -46.2585 -168.805 -48.0144 -169.512 -49.7663 -170.259 -51.5139 -171.053 -53.2567 -171.9 -54.9942 -172.807 -56.7254 -173.785 -58.4497 -174.845 -60.1658 -176 -61.8726 -177.267 -63.5681 -178.669 -65.2504 179.769 -66.9167 178.014 -68.5633 176.021 -70.1856 173.737 -71.7772 171.09 -73.3295 167.984 -74.8306 164.298 -76.2638 159.87 -77.6056 154.498 -78.8235 147.942 -79.8725 139.96 -80.6956 130.403 -81.229 119.387 -81.4186 107.448 -81.4204 107.448 -81.2308 119.389 -80.6973 130.408 -79.874 139.965 -78.8249 147.948 -77.6069 154.504 -76.2649 159.876 -74.8316 164.303 -73.3305 167.989 -71.7781 171.094 -70.1864 173.742 -68.5641 176.026 -66.9174 178.018 -65.2511 179.773 -63.5688 -178.665 -61.8732 -177.264 -60.1664 -175.996 -58.4503 -174.841 -56.726 -173.782 -54.9947 -172.804 -53.2573 -171.897 -51.5144 -171.05 -49.7668 -170.257 -48.0148 -169.509 -46.259 -168.802 -44.4997 -168.131 -42.7372 -167.492 -40.9717 -166.881 -39.2036 -166.294 -37.433 -165.731 -35.6601 -165.187 -33.885 -164.661 -32.108 -164.152 -30.3292 -163.657 -28.5487 -163.175 -26.7665 -162.705 -24.9829 -162.245 -23.198 -161.794 -21.4117 -161.352 -19.6243 -160.918 -17.8359 -160.49 -16.0464 -160.068 -14.2561 -159.652 -12.465 -159.239 -10.6731 -158.831 -8.88061 -158.426 -7.08757 -158.024 -5.29407 -157.623 -3.5002 -157.225 -1.70602 -156.827 0.0883605 -156.43 1.88287 -156.032 3.67743 -155.634 5.47195 -155.235 7.26635 -154.835 9.06054 -154.432 10.8544 -154.026 12.6479 -153.617 14.441 -153.204 16.2335 -152.787 18.0253 -152.364 19.8164 -151.935 21.6067 -151.499 23.396 -151.056 25.1843 -150.604 26.9715 -150.142 28.7573 -149.67 30.5419 -149.186 32.3249 -148.688 34.1063 -148.176 35.8858 -147.647 37.6635 -147.1 39.439 -146.532 41.2122 -145.941 42.9829 -145.325 44.7508 -144.68 46.5155 -144.002 48.2769 -143.287 50.0345 -142.531 51.7879 -141.727 53.5365 -140.869 55.2797 -139.947 57.0167 -138.954 58.7466 -137.876 60.4682 -136.698 62.1802 -135.404 63.8807 -133.97 65.5675 -132.369 67.2376 -130.564 68.8872 -128.512 70.5112 -126.152 72.1028 -123.408 73.6526 -120.179 75.1477 -116.333 76.5699 -111.698 77.8937 -106.059 79.0832 -99.167 80.0902 -90.7874 80.8543 -80.8135 81.3111 -69.4527 81.4116 -57.3587 81.4134 -57.3581";
      footprintStub(footprint, "sr1 intersection");
   }

   @Test
   public void testEfrBananino()
   {
      String footprint = "86.7279 -114.472 86.7057 -125.292 86.5612 -135.555 86.3172 -144.726 85.9917 -152.587 85.6028 -159.166 85.1659 -164.62 84.6927 -169.138 84.1921 -172.9 83.6706 -176.055 83.1329 -178.725 82.5827 178.995 82.0224 177.03 81.454 175.324 80.8791 173.831 80.2987 172.513 79.7139 171.344 79.1253 170.299 78.5335 169.361 77.9361 168.563 77.6218 173.135 78.2047 174.133 78.7797 175.284 79.3497 176.556 79.9141 177.97 80.4717 179.548 81.0213 -178.681 81.5614 -176.683 82.0899 -174.417 82.6046 -171.834 83.1021 -168.873 83.5786 -165.465 84.029 -161.53 84.4471 -156.98 84.8248 -151.732 85.1528 -145.718 85.4204 -138.921 85.6166 -131.403 85.7315 -123.334 85.7489 -114.994 86.7279 -114.472";
      footprintStub(footprint, "OLCI bananino");
   }

   @Test
   public void testSlstrSouthPole()
   {
      // S3A_SL_1_RBT____20170228T020812_20170228T021112_20170228T033447_0179_015_017_4499_SVL_O_NR_002.SEN3
      String footprint = "-70.4477 2.18368 -70.9684 1.45577 -71.4861 0.688619 -72.0005 -0.120913 -72.5113 -0.976256 -73.0182 -1.88118 -73.5208 -2.83984 -74.0188 -3.85678 -74.5116 -4.937 -74.9989 -6.086 -75.48 -7.30979 -75.9544 -8.61495 -76.4212 -10.0087 -76.8797 -11.4988 -77.3291 -13.0937 -77.7682 -14.8025 -78.196 -16.6348 -78.6112 -18.6008 -79.0124 -20.7109 -79.3979 -22.9756 -79.766 -25.4052 -80.1148 -28.0091 -80.4422 -30.7954 -80.7458 -33.7701 -81.0233 -36.9358 -81.2722 -40.291 -81.49 -43.829 -81.6742 -47.5368 -81.8226 -51.3944 -81.9331 -55.3753 -82.0043 -59.4462 -82.0351 -63.5689 -82.0249 -67.7022 -82.016 -68.7323 -84.5548 -70.8282 -87.1071 -77.4161 -89.2345 -137.182 -87.492 135.202 -87.5294 132.016 -87.598 118.591 -87.5319 105.152 -87.3409 93.0367 -87.0494 82.9272 -86.6837 74.8366 -86.2656 68.4512 -85.8108 63.3987 -85.3299 59.3589 -84.8302 56.0846 -84.3167 53.3929 -83.7928 51.15 -83.2609 49.2572 -82.7228 47.6416 -82.1797 46.2483 -81.6326 45.0354 -81.0823 43.9708 -80.5293 43.0292 -79.974 42.1908 -79.4168 41.4397 -78.8579 40.763 -78.2977 40.1502 -77.7363 39.5927 -77.1738 39.0833 -76.6104 38.616 -76.0462 38.1858 -75.4813 37.7885 -74.9157 37.4202 -74.3495 37.078 -73.7828 36.7592 -73.2156 36.4613 -72.648 36.1823 -72.08 35.9204 -72.2504 27.0691 -72.0184 18.2473 -71.3991 9.82037 -70.4477 2.18368";
      footprintStub(footprint, "SLSTR south pole");
   }

   @Test
   public void testSlstrNorthPole()
   {
      String footprint = "83.7357 80.0522 83.7546 85.3112 83.7213 90.5581 83.6365 95.7078 83.5023 100.684 83.3217 105.426 83.0982 109.891 82.836 114.054 82.539 117.907 82.2113 121.451 81.8566 124.7 81.4782 127.671 81.0792 130.385 80.6622 132.863 80.2294 135.127 79.783 137.198 79.3245 139.096 78.8555 140.837 78.3773 142.438 77.8909 143.914 77.3974 145.276 76.8974 146.536 76.3917 147.705 75.8809 148.792 75.3655 149.804 74.8461 150.748 74.3229 151.63 73.7964 152.457 73.2669 153.234 72.7346 153.963 72.1998 154.651 71.6627 155.299 71.1235 155.912 70.9884 156.06 71.7139 164.137 72.0764 172.839 72.038 -178.306 71.6014 -169.674 71.7409 -169.569 72.2983 -169.131 72.8546 -168.666 73.4098 -168.171 73.9637 -167.643 74.5162 -167.077 75.0671 -166.472 75.6162 -165.821 76.1635 -165.119 76.7085 -164.361 77.2511 -163.54 77.7909 -162.647 78.3275 -161.673 78.8606 -160.607 79.3894 -159.436 79.9135 -158.143 80.432 -156.712 80.944 -155.119 81.4482 -153.339 81.9433 -151.34 82.4274 -149.083 82.8984 -146.526 83.3533 -143.613 83.7888 -140.285 84.2005 -136.471 84.5828 -132.1 84.9291 -127.101 85.2317 -121.421 85.4816 -115.046 85.6699 -108.023 85.7882 -100.486 85.8305 -92.6582 85.7945 -84.8183 88.3373 -72.3555 88.7863 56.9057 86.2836 76.6766 83.7357 80.0522";
      footprintStub(footprint, "SLSTR north pole");
   }

   @Test
   public void testSlstrL2PAC()
   {
      String footprint = "89.5039 103.165 89.6419 40.9216 89.3493 -2.13668 88.9271 -14.4863 88.4921 -19.904 88.0447 -22.9297 87.5937 -24.8254 87.141 -26.1215 86.6806 -27.2184 86.2286 -27.8758 85.7778 -28.3313 85.3144 -28.8712 84.8612 -29.1885 84.4113 -29.4644 83.9554 -29.728 83.4917 -29.9688 83.0347 -30.1589 82.5788 -30.3445 82.1291 -30.5032 81.6717 -30.6385 81.2162 -30.7697 80.7606 -30.8902 80.3009 -30.9425 79.8467 -31.0544 79.394 -31.1616 78.9417 -31.2217 78.4865 -31.2791 78.0297 -31.342 77.5705 -31.4087 77.1217 -31.4623 76.9305 -31.4732 76.7612 -23.5154 76.0347 -11.8211 74.8201 -1.59935 73.223 6.94782 71.3412 13.9511 69.2517 19.6678 67.0109 24.3637 64.6456 28.2828 62.2095 31.56 59.7101 34.3535 57.1614 36.7656 54.5739 38.8732 51.9554 40.7356 49.3115 42.3982 46.6468 43.8963 43.9648 45.2579 41.2682 46.505 38.5591 47.6555 35.8395 48.7239 33.1108 49.7221 30.3741 50.6599 27.6307 51.5454 24.8813 52.3856 22.1269 53.1864 19.368 53.9528 16.6054 54.6891 13.8396 55.3992 11.071 56.0862 8.30034 56.7532 5.52788 57.4029 2.75407 58.0375 -0.020686 58.6593 -2.79604 59.2703 -5.57164 59.8723 -8.34717 60.4673 -11.1223 61.0569 -13.8968 61.6429 -16.6704 62.2271 -19.4427 62.8111 -22.2137 63.3968 -24.983 63.9863 -27.7504 64.5816 -30.5157 65.1851 -33.2788 65.7996 -36.0394 66.4279 -38.7974 67.0738 -41.5525 67.7415 -44.3045 68.4361 -47.0533 69.1639 -49.7986 69.9328 -52.54 70.7528 -55.2771 71.6372 -58.0093 72.6033 -60.7359 73.6748 -63.4558 74.8849 -66.1674 76.2815 -68.8681 77.9365 -71.5539 79.9626 -74.2182 82.5461 -76.8485 86.0182 -79.4206 91.0148 -81.8797 98.8865 -84.0843 112.759 -85.6318 138.847 -85.7343 176.22 -84.3131 -155.877 -82.1569 -140.942 -79.7176 -132.578 -77.155 -127.334 -74.5299 -123.724 -71.8687 -121.057 -69.1849 -118.977 -66.4855 -117.285 -63.775 -115.863 -61.0558 -114.633 -58.3297 -113.548 -55.5979 -112.57 -52.8612 -111.677 -50.1201 -110.85 -47.375 -110.076 -44.6264 -109.344 -41.8745 -108.646 -39.1194 -107.975 -36.3615 -107.327 -33.601 -106.697 -30.8379 -106.081 -28.0725 -105.476 -25.305 -104.88 -22.5356 -104.29 -19.7646 -103.704 -16.992 -103.12 -14.2183 -102.536 -11.4436 -101.95 -8.66814 -101.361 -5.8923 -100.766 -3.11636 -100.165 -0.340623 -99.5554 2.43456 -98.9349 5.20882 -98.3019 7.98179 -97.6541 10.753 -96.9892 13.5221 -96.3045 16.2886 -95.5973 19.0519 -94.8641 21.8116 -94.1014 24.5668 -93.3047 27.3171 -92.4693 30.0615 -91.5892 32.7993 -90.6578 35.5292 -89.667 38.2502 -88.6071 40.9608 -87.4665 43.6592 -86.2312 46.3432 -84.8837 49.0102 -83.4024 51.6568 -81.7601 54.2787 -79.9225 56.8702 -77.8454 59.4239 -75.4714 61.9297 -72.7257 64.3739 -69.5094 66.7375 -65.6917 68.9935 -61.1014 71.1035 -55.5186 73.0137 -48.6825 74.6496 -40.3295 75.9151 -30.3033 76.7048 -18.7569 76.9321 -6.32273 77.1102 -6.34328 77.5678 -6.25014 78.024 -6.20103 78.4811 -6.132 78.9357 -6.08085 79.3897 -6.02723 79.8438 -5.92661 80.3002 -5.87825 80.7605 -5.77473 81.2178 -5.66458 81.6737 -5.54049 82.1311 -5.39815 82.5825 -5.25265 83.0386 -5.09043 83.4929 -4.90757 83.9572 -4.75299 84.413 -4.51464 84.8615 -4.18284 85.3248 -3.81987 85.7728 -3.39435 86.228 -2.97503 86.6902 -2.17907 87.1393 -1.3282 87.5977 -0.214581 88.045 1.54821 88.4956 4.32334 88.9376 9.37375 89.3588 22.0052 89.6617 65.0758 89.5162 130.54 87.5656 -106.631 84.8551 -102.555 82.1342 -101.575 79.4105 -101.308 76.6852 -101.317 73.9586 -101.463 71.2309 -101.687 68.5018 -101.96 65.7714 -102.266 63.0396 -102.597 60.3063 -102.946 57.5714 -103.309 54.8349 -103.685 52.0967 -104.072 49.3568 -104.469 46.6151 -104.875 43.8717 -105.289 41.1267 -105.712 38.38 -106.144 35.6317 -106.583 32.882 -107.032 30.131 -107.49 27.3787 -107.957 24.6254 -108.434 21.8713 -108.922 19.1166 -109.421 16.3615 -109.933 13.6064 -110.457 10.8514 -110.995 8.09694 -111.549 5.3434 -112.119 2.59112 -112.706 -0.159459 -113.314 -2.90789 -113.942 -5.65368 -114.594 -8.39629 -115.271 -11.1351 -115.977 -13.8696 -116.714 -16.5989 -117.486 -19.3223 -118.296 -22.0389 -119.15 -24.7478 -120.052 -27.4478 -121.009 -30.1375 -122.027 -32.8156 -123.116 -35.4802 -124.285 -38.1294 -125.546 -40.7606 -126.914 -43.3708 -128.404 -45.9565 -130.039 -48.5131 -131.844 -51.0352 -133.848 -53.5156 -136.09 -55.9456 -138.617 -58.3138 -141.485 -60.6054 -144.766 -62.8014 -148.545 -64.8769 -152.921 -66.7999 -158.006 -68.5295 -163.913 -70.0158 -170.731 -71.2013 -178.484 -72.0263 172.919 -72.4402 163.731 -72.4141 154.344 -71.9496 145.207 -71.0793 136.7 -69.8553 129.055 -68.3375 122.348 -66.5827 116.543 -64.6399 111.547 -62.5488 107.247 -60.3405 103.532 -58.0391 100.304 -55.6631 97.4789 -53.2268 94.9886 -50.7412 92.7767 -48.2149 90.7978 -45.6548 89.0151 -43.0662 87.3983 -40.4536 85.923 -37.8204 84.5688 -35.1695 83.3192 -32.5035 82.1602 -29.8242 81.0801 -27.1335 80.0692 -24.4327 79.1192 -21.7231 78.2231 -19.006 77.3749 -16.2821 76.5692 -13.5525 75.8018 -10.8178 75.0687 -8.0788 74.3664 -5.33612 73.6921 -2.59031 73.0432 0.158065 72.4173 2.90854 71.8125 5.66065 71.2269 8.414 70.659 11.1682 70.1074 13.9229 69.5707 16.6778 69.048 19.4325 68.5381 22.1869 68.0402 24.9406 67.5535 27.6935 67.0774 30.4453 66.6113 33.196 66.1546 35.9453 65.7069 38.6931 65.268 41.4394 64.8375 44.184 64.4155 46.927 64.002 49.6683 63.5971 52.4078 63.2014 55.1457 62.8155 57.8819 62.4404 60.6164 62.078 63.3494 61.7307 66.0809 61.4024 68.8111 61.099 71.5548 60.829 74.2823 60.612 77.0087 60.4773 79.7338 60.4894 82.4573 60.8051 85.1777 61.9363 87.8849 67.0233 89.5039 103.165";
      footprintStub(footprint, "SLSTR l2 pac v1");
   }

   @Test
   public void testSlstrL2PAC_v2()
   {
      String footprint = "89.5162 -46.4516 89.6604 -111.547 89.3605 -155.235 88.9344 -167.035 88.4967 -172.119 88.0483 -174.982 87.5969 -176.773 87.1437 -177.997 86.6897 -178.882 86.2265 -179.594 85.7747 179.889 85.3244 179.494 84.8625 179.09 84.4116 178.832 83.9559 178.588 83.493 178.359 83.0385 178.175 82.5814 178.002 82.1302 177.858 81.6732 177.725 81.2172 177.602 80.7598 177.544 80.2996 177.438 79.8443 177.333 79.3937 177.288 78.937 177.179 78.4806 177.127 78.0223 177.071 77.5613 177.011 77.1106 176.964 76.9315 176.958 76.7622 -175.004 76.036 -163.307 74.8217 -153.084 73.2151 -144.492 71.332 -137.496 69.2416 -131.784 67 -127.093 64.6472 -123.197 62.2111 -119.919 59.7116 -117.125 57.1628 -114.713 54.5753 -112.605 51.9566 -110.743 49.3127 -109.08 46.6479 -107.582 43.9658 -106.22 41.2691 -104.973 38.56 -103.823 35.8402 -102.754 33.1114 -101.756 30.3747 -100.818 27.6312 -99.9326 24.8818 -99.0924 22.1272 -98.2916 19.3683 -97.5252 16.6056 -96.7889 13.8397 -96.0789 11.0712 -95.3918 8.30042 -94.7248 5.52791 -94.0752 2.75405 -93.4405 -0.020749 -92.8187 -2.79614 -92.2077 -5.57177 -91.6056 -8.34733 -91.0106 -11.1225 -90.421 -13.897 -89.835 -16.6706 -89.2508 -19.4429 -88.6668 -22.2139 -88.081 -24.9831 -87.4915 -27.7505 -86.8961 -30.5159 -86.2926 -33.2789 -85.6781 -36.0395 -85.0497 -38.7974 -84.4037 -41.5525 -83.736 -44.3045 -83.0413 -47.0532 -82.3135 -49.7984 -81.5445 -52.5397 -80.7243 -55.2768 -79.8398 -58.0089 -78.8735 -60.7355 -77.8019 -63.4553 -76.5916 -66.1668 -75.1948 -68.8674 -73.5396 -71.5531 -71.5131 -74.2173 -68.9292 -76.8475 -65.4567 -79.4194 -60.4597 -81.8784 -52.5884 -84.0828 -38.7172 -85.6302 -12.6372 -85.7335 24.7237 -84.313 52.6269 -82.1572 67.5656 -79.7182 75.9333 -77.1558 81.1792 -74.5308 84.7906 -71.8698 87.4585 -69.186 89.5393 -66.4868 91.2316 -63.7763 92.6547 -61.0572 93.8842 -58.3312 94.9704 -55.5995 95.9477 -52.8628 96.8409 -50.1217 97.668 -47.3767 98.4425 -44.6281 99.1748 -41.8762 99.873 -39.1212 100.544 -36.3633 101.192 -33.6028 101.822 -30.8397 102.438 -28.0744 103.043 -25.3069 103.639 -22.5375 104.229 -19.7664 104.816 -16.9939 105.4 -14.2201 105.984 -11.4454 106.57 -8.66993 107.159 -5.89406 107.753 -3.11807 108.354 -0.342295 108.964 2.43294 109.585 5.20726 110.218 7.98028 110.866 10.7516 111.531 13.5208 112.216 16.2873 112.923 19.0507 113.656 21.8104 114.419 24.5657 115.216 27.3161 116.051 30.0606 116.931 32.7984 117.863 35.5284 118.854 38.2495 119.914 40.9601 121.055 43.6586 122.29 46.3427 123.638 49.0097 125.12 51.6564 126.762 54.2783 128.6 56.8699 130.678 59.4236 133.052 61.9294 135.798 64.3737 139.015 66.7371 142.834 68.993 147.425 71.103 153.008 73.0129 159.845 74.6485 168.199 75.9137 178.226 76.703 -170.228 76.9298 -157.795 77.1089 -157.775 77.5656 -157.722 78.0224 -157.68 78.4789 -157.603 78.934 -157.56 79.3878 -157.505 79.8419 -157.405 80.2984 -157.307 80.7584 -157.252 81.2155 -157.142 81.6714 -157.018 82.1289 -156.875 82.5801 -156.73 83.0362 -156.567 83.4993 -156.363 83.9545 -156.23 84.4102 -155.992 84.8586 -155.661 85.3218 -155.299 85.7697 -154.874 86.2332 -154.303 86.688 -153.7 87.1361 -152.813 87.5944 -151.704 88.0418 -149.946 88.4924 -147.184 88.9343 -142.17 89.3565 -129.38 89.6595 -86.5462 89.5171 -21.3864 87.5677 101.933 84.8569 105.988 82.1358 106.961 79.412 107.223 76.6866 107.211 73.9599 107.064 71.232 106.839 68.5028 106.565 65.7723 106.258 63.0404 105.927 60.307 105.578 57.572 105.214 54.8353 104.837 52.097 104.45 49.3569 104.053 46.6152 103.647 43.8717 103.232 41.1265 102.809 38.3797 102.378 35.6313 101.938 32.8815 101.489 30.1304 101.031 27.378 100.564 24.6246 100.086 21.8705 99.5982 19.1156 99.0989 16.3605 98.5875 13.6052 98.0631 10.8502 97.5247 8.09568 96.9711 5.34207 96.4012 2.58973 95.8134 -0.160902 95.2061 -2.90938 94.5776 -5.65521 93.9257 -8.39786 93.2482 -11.1367 92.5425 -13.8712 91.8054 -16.6005 91.0336 -19.3239 90.2232 -22.0405 89.3695 -24.7494 88.4673 -27.4493 87.5105 -30.139 86.4918 -32.8171 85.4029 -35.4817 84.2337 -38.1308 82.9724 -40.7619 81.6048 -43.3721 80.1138 -45.9577 78.4787 -48.5142 76.6744 -51.0362 74.6699 -53.5165 72.4276 -55.9464 69.9007 -58.3144 67.0317 -60.6059 63.7505 -62.8017 59.9717 -64.877 55.5953 -66.7998 50.5101 -68.5292 44.6026 -70.0153 37.7848 -71.2005 30.0315 -72.0253 21.4354 -72.4391 12.2478 -72.4127 2.86198 -71.9482 -6.27383 -71.0779 -14.7799 -69.8538 -22.4241 -68.3361 -29.1311 -66.5814 -34.9354 -64.6386 -39.9307 -62.5477 -44.2305 -60.3395 -47.9453 -58.0382 -51.1735 -55.6623 -53.9986 -53.226 -56.4889 -50.7405 -58.7008 -48.2143 -60.6797 -45.6543 -62.4624 -43.0658 -64.0793 -40.4532 -65.5546 -37.8201 -66.9088 -35.1693 -68.1585 -32.5033 -69.3175 -29.8241 -70.3976 -27.1334 -71.4086 -24.4327 -72.3585 -21.7232 -73.2547 -19.006 -74.103 -16.2822 -74.9086 -13.5526 -75.6761 -10.8179 -76.4093 -8.0789 -77.1115 -5.33621 -77.7858 -2.5904 -78.4348 0.157997 -79.0607 2.90849 -79.6655 5.66064 -80.2511 8.41401 -80.819 11.1682 -81.3706 13.923 -81.9073 16.6779 -82.43 19.4327 -82.9399 22.1871 -83.4378 24.9409 -83.9244 27.6938 -84.4005 30.4457 -84.8667 33.1964 -85.3234 35.9458 -85.771 38.6937 -86.2099 41.4401 -86.6403 44.1848 -87.0623 46.9278 -87.4758 49.6692 -87.8806 52.4088 -88.2763 55.1468 -88.6622 57.883 -89.0371 60.6177 -89.3994 63.3508 -89.7466 66.0824 -90.0748 68.8126 -90.3779 71.5415 -90.6464 74.2692 -90.8634 76.9956 -90.9981 79.7208 -90.9864 82.4593 -90.6685 85.1798 -89.5334 87.887 -84.4294 89.5162 -46.4516";
      footprintStub(footprint, "SLSTR l2 pac v2");
   }

   @Test
   public void testSlstrL2PAC_v3()
   {
      String footprint = "89.5151 28.6547 89.6635 -36.5296 89.3535 -78.6112 88.9368 -91.3773 88.4882 -96.4545 88.0382 -99.2546 87.5911 -101.043 87.1387 -102.261 86.6851 -103.08 86.2318 -103.746 85.7707 -104.365 85.3213 -104.711 84.8587 -105.163 84.408 -105.42 83.9524 -105.664 83.4897 -105.893 83.0353 -106.077 82.5783 -106.251 82.1272 -106.395 81.6698 -106.47 81.2141 -106.597 80.7569 -106.71 80.2969 -106.816 79.8473 -106.868 79.3869 -106.969 78.9331 -107.025 78.4777 -107.088 78.02 -107.185 77.559 -107.246 77.1078 -107.262 76.9287 -107.282 76.7587 -99.2453 76.0317 -87.5529 74.8167 -77.3329 73.2193 -68.7875 71.3372 -61.7855 69.2475 -56.0696 67.0066 -51.3743 64.6542 -47.475 62.2049 -44.1786 59.7053 -41.3853 57.1565 -38.9734 54.5688 -36.8658 51.9501 -35.0034 49.3062 -33.3408 46.6414 -31.8426 43.9592 -30.481 41.2625 -29.2338 38.5534 -28.0832 35.8336 -27.0147 33.1048 -26.0165 30.3681 -25.0786 27.6245 -24.193 24.8751 -23.3527 22.1206 -22.5518 19.3617 -21.7853 16.599 -21.0489 13.8332 -20.3387 11.0646 -19.6516 8.2939 -18.9844 5.52142 -18.3347 2.74761 -17.6999 -0.027152 -17.078 -2.8025 -16.4669 -5.57809 -15.8646 -8.3536 -15.2695 -11.1287 -14.6797 -13.9032 -14.0936 -16.6767 -13.5093 -19.449 -12.925 -22.2199 -12.3391 -24.9891 -11.7494 -27.7564 -11.1538 -30.5217 -10.5501 -33.2846 -9.93536 -36.0452 -9.30668 -38.803 -8.66047 -41.558 -7.99244 -44.31 -7.29747 -47.0587 -6.56925 -49.8038 -5.79983 -52.545 -4.97917 -55.282 -4.0941 -58.0141 -3.12722 -60.7405 -2.05482 -63.4603 -0.843553 -66.1716 0.554442 -68.8721 2.21116 -71.5577 4.23962 -74.2217 6.82638 -76.8517 10.3029 -79.4231 15.3065 -81.8815 23.1887 -84.0846 37.0791 -85.6293 63.1811 -85.7291 100.52 -84.3072 128.384 -82.1513 143.307 -79.7123 151.67 -77.15 156.914 -74.5251 160.526 -71.8641 163.194 -69.1805 165.275 -66.4813 166.967 -63.7708 168.391 -61.0518 169.621 -58.3258 170.707 -55.5941 171.685 -52.8574 172.578 -50.1164 173.406 -47.3714 174.18 -44.6228 174.913 -41.8709 175.611 -39.1159 176.282 -36.358 176.931 -33.5974 177.561 -30.8343 178.177 -28.0689 178.782 -25.3014 179.379 -22.532 179.969 -19.7609 -179.445 -16.9883 -178.86 -14.2145 -178.276 -11.4397 -177.69 -8.66416 -177.101 -5.88824 -176.506 -3.1122 -175.905 -0.336368 -175.295 2.43892 -174.674 5.2133 -174.041 7.98638 -173.393 10.7578 -172.727 13.527 -172.043 16.2936 -171.335 19.057 -170.602 21.8168 -169.839 24.5722 -169.042 27.3226 -168.206 30.0672 -167.325 32.805 -166.394 35.5351 -165.402 38.2562 -164.342 40.9669 -163.201 43.6654 -161.965 46.3495 -160.617 49.0166 -159.134 51.6632 -157.491 54.2851 -155.652 56.8766 -153.574 59.4303 -151.198 61.936 -148.451 64.38 -145.232 66.7433 -141.411 68.9988 -136.817 71.1082 -131.23 73.0174 -124.389 74.652 -116.03 75.9158 -105.998 76.7034 -94.4486 76.9284 -82.0151 77.1023 -82.0027 77.5588 -81.9637 78.0235 -81.9155 78.4701 -81.8397 78.9326 -81.794 79.3875 -81.6939 79.8402 -81.6371 80.2967 -81.5371 80.7568 -81.4282 81.2134 -81.3051 81.669 -81.2362 82.1268 -81.1001 82.578 -80.9525 83.0339 -80.788 83.4975 -80.5759 83.953 -80.3491 84.4089 -80.0968 84.8653 -79.7689 85.3198 -79.4954 85.7678 -79.062 86.2258 -78.4526 86.6783 -77.8034 87.1349 -76.9562 87.5852 -75.7726 88.0439 -73.7446 88.4919 -70.8162 88.9325 -65.4556 89.3482 -53.3932 89.651 -10.5739 89.5122 53.5022 87.5763 177.675 84.8654 -178.263 82.1443 -177.291 79.4203 -177.03 76.6948 -177.043 73.9681 -177.191 71.2401 -177.416 68.5108 -177.69 65.7803 -177.998 63.0483 -178.329 60.3148 -178.679 57.5797 -179.043 54.8429 -179.42 52.1045 -179.807 49.3644 179.796 46.6226 179.39 43.879 178.975 41.1337 178.552 38.3869 178.12 35.6384 177.68 32.8886 177.231 30.1373 176.773 27.3849 176.306 24.6315 175.828 21.8772 175.34 19.1224 174.841 16.3671 174.329 13.6118 173.805 10.8567 173.266 8.10219 172.712 5.34853 172.142 2.59616 171.555 -0.154518 170.947 -2.90304 170.319 -5.6489 169.667 -8.39158 168.989 -11.1305 168.283 -13.865 167.546 -16.5943 166.774 -19.3178 165.964 -22.0344 165.11 -24.7433 164.208 -27.4433 163.251 -30.133 162.232 -32.8111 161.143 -35.4757 159.974 -38.1248 158.712 -40.7559 157.345 -43.3661 155.854 -45.9517 154.219 -48.5082 152.415 -51.0302 150.41 -53.5105 148.168 -55.9404 145.642 -58.3084 142.773 -60.5999 139.492 -62.7958 135.715 -64.8712 131.339 -66.7942 126.255 -68.5237 120.35 -70.0102 113.534 -71.1958 105.783 -72.0212 97.19 -72.4357 88.0046 -72.4102 78.6203 -71.9466 69.485 -71.0771 60.9786 -69.8539 53.3333 -68.3368 46.625 -66.5827 40.8192 -64.6405 35.8225 -62.55 31.5213 -60.3421 27.8053 -58.0412 24.576 -55.6655 21.75 -53.2295 19.2589 -50.7442 17.0462 -48.2182 15.0667 -45.6584 13.2833 -43.07 11.666 -40.4576 10.1902 -37.8246 8.83558 -35.1739 7.58549 -32.508 6.42609 -29.8289 5.34566 -27.1383 4.33444 -24.4376 3.38417 -21.7282 2.48776 -19.0111 1.63922 -16.2874 0.833338 -13.5578 0.065635 -10.8232 -0.667743 -8.08431 -1.37021 -5.34167 -2.04472 -2.59592 -2.69387 0.152427 -3.31995 2.90287 -3.92497 5.65498 -4.51073 8.40831 -5.07883 11.1625 -5.63067 13.9172 -6.16751 16.6721 -6.69047 19.4269 -7.20054 22.1813 -7.69862 24.935 -8.18547 27.688 -8.66178 30.4399 -9.12815 33.1906 -9.58506 35.94 -10.0329 38.6879 -10.4721 41.4343 -10.9028 44.179 -11.325 46.9221 -11.7388 49.6635 -12.144 52.4032 -12.5401 55.1412 -12.9264 57.8775 -13.3018 60.6122 -13.6647 63.3454 -14.0125 66.077 -14.3415 68.8223 -14.6472 71.5512 -14.9167 74.279 -15.135 77.0055 -15.2715 79.7308 -15.2622 82.4545 -14.9514 85.1751 -13.8307 87.8827 -8.78509 89.5151 28.6547";
      footprintStub(footprint, "SLSTR l2 pac v3");
   }

   @Test
   public void testSlstrL2PAC_v4()
   {
      // broken
      String footprint = "89.3932 67.9659 89.8556 138.166 89.4189 -139.854 88.8564 -132.845 88.2871 -130.448 87.7159 -129.245 87.144 -128.522 86.5717 -128.04 85.9992 -127.696 85.4265 -127.438 84.8538 -127.237 84.281 -127.077 83.7081 -126.945 83.1352 -126.835 82.5623 -126.743 81.9893 -126.663 81.4163 -126.594 80.8433 -126.533 80.2702 -126.48 79.6971 -126.432 79.124 -126.39 78.5508 -126.351 77.9776 -126.317 77.4044 -126.285 76.8312 -126.256 76.2579 -126.229 75.6846 -126.205 75.1113 -126.182 74.5379 -126.161 73.9645 -126.142 73.3911 -126.124 72.8176 -126.107 72.2442 -126.091 72.1008 -126.087 72.0238 -120.121 71.5501 -111.141 70.6752 -102.774 69.4507 -95.2394 67.9344 -88.6116 66.1818 -82.8603 64.2412 -77.8972 61.9759 -73.3102 59.7598 -69.6455 57.4515 -66.4539 55.0689 -63.6555 52.6263 -61.1847 50.1346 -58.987 47.6024 -57.0185 45.0365 -55.2434 42.4422 -53.6322 39.8241 -52.1612 37.1857 -50.8103 34.5299 -49.5633 31.8592 -48.4065 29.1757 -47.3283 26.481 -46.3193 23.7768 -45.3711 21.0643 -44.477 18.3447 -43.6308 15.619 -42.8275 12.888 -42.0626 10.1525 -41.3323 7.4134 -40.6333 4.6712 -39.9626 1.92652 -39.3177 -0.820084 -38.6964 -3.56812 -38.0966 -6.31712 -37.5166 -9.06669 -36.9549 -11.8164 -36.4101 -14.566 -35.881 -17.3151 -35.3667 -20.0634 -34.8661 -22.8106 -34.3785 -25.5566 -33.9032 -28.3011 -33.4397 -31.044 -32.9876 -33.7851 -32.5465 -36.5243 -32.1163 -39.2614 -31.697 -41.9965 -31.2887 -44.7294 -30.8917 -47.4601 -30.5067 -50.1887 -30.1346 -52.9151 -29.7766 -55.6394 -29.4348 -58.3615 -29.1119 -61.0816 -28.8118 -63.7998 -28.5403 -66.516 -28.3058 -69.2304 -28.1215 -71.9429 -28.0087 -74.6535 -28.0038 -77.3619 -28.1748 -80.0674 -28.6634 -82.7679 -29.8241 -85.456 -32.8484 -88.0815 -45.4789 -88.817 -164.905 -86.2853 168.83 -83.6057 164.486 -80.9077 162.956 -78.2033 162.313 -75.4955 162.065 -72.7854 162.024 -70.0733 162.109 -67.3593 162.273 -64.6434 162.494 -61.9256 162.755 -59.2059 163.047 -56.484 163.363 -53.7601 163.7 -51.034 164.053 -48.3058 164.421 -45.5753 164.802 -42.8427 165.195 -40.1078 165.6 -37.3709 166.016 -34.6318 166.443 -31.8909 166.881 -29.148 167.33 -26.4035 167.79 -23.6574 168.261 -20.9099 168.745 -18.1614 169.242 -15.4119 169.752 -12.6619 170.276 -9.91163 170.816 -7.16139 171.373 -4.41159 171.947 -1.66264 172.541 1.08503 173.155 3.83093 173.793 6.57451 174.455 9.31522 175.146 12.0524 175.866 14.7854 176.62 17.5133 177.411 20.2355 178.244 22.9507 179.123 25.6581 -179.946 28.3563 -178.956 31.0438 -177.899 33.719 -176.768 36.38 -175.549 39.0244 -174.231 41.6494 -172.798 44.2516 -171.232 46.827 -169.509 49.3703 -167.602 51.8754 -165.478 54.3342 -163.095 56.7364 -160.402 59.0691 -157.337 61.3154 -153.824 63.4536 -149.775 65.4556 -145.086 67.2853 -139.648 68.8982 -133.363 70.2413 -126.174 71.2565 -118.109 71.889 -109.329 72.0977 -100.146 72.2411 -100.144 72.8146 -100.137 73.3881 -100.13 73.9616 -100.122 74.535 -100.113 75.1083 -100.104 75.6817 -100.094 76.255 -100.083 76.8283 -100.071 77.4016 -100.058 77.9748 -100.044 78.548 -100.029 79.1212 -100.012 79.6944 -99.9929 80.2675 -99.9718 80.8407 -99.9481 81.4138 -99.9213 81.9869 -99.8907 82.5599 -99.8554 83.133 -99.8142 83.706 -99.7656 84.279 -99.7073 84.8519 -99.6361 85.4249 -99.5471 85.9978 -99.4327 86.5706 -99.2801 87.1434 -99.0665 87.716 -98.7459 88.2884 -98.2112 88.8602 -97.1415 89.4296 -93.9489 89.9156 44.1383 89.4102 73.4717 87.2771 156.879 84.5853 162.653 81.8719 164.313 79.1527 164.937 76.4308 165.146 73.7069 165.147 70.9814 165.028 68.2545 164.834 65.526 164.589 62.796 164.307 60.0643 163.998 57.3311 163.666 54.5961 163.317 51.8593 162.953 49.1209 162.576 46.3806 162.187 43.6387 161.786 40.895 161.376 38.1497 160.955 35.4028 160.524 32.6544 160.083 29.9047 159.632 27.1538 159.17 24.4019 158.698 21.6492 158.214 18.8959 157.717 16.1423 157.208 13.3886 156.685 10.6352 156.148 7.88235 155.595 5.13045 155.024 2.3799 154.435 -0.368877 153.826 -3.11541 153.195 -5.8592 152.54 -8.59969 151.859 -11.3363 151.148 -14.0683 150.406 -16.795 149.628 -19.5157 148.81 -22.2293 147.948 -24.9349 147.036 -27.6312 146.068 -30.3171 145.037 -32.9908 143.934 -35.6506 142.749 -38.2944 141.47 -40.9196 140.082 -43.5231 138.569 -46.1012 136.907 -48.6491 135.074 -51.1612 133.036 -53.6301 130.755 -56.0468 128.184 -58.3993 125.266 -60.6725 121.929 -62.8467 118.089 -64.8965 113.647 -66.7892 108.494 -68.4834 102.525 -69.9291 95.6594 -71.0696 87.8882 -71.8472 79.3184 -72.2146 70.2102 -72.1465 60.9526 -71.6475 51.9752 -70.7513 43.6333 -69.5096 36.1387 -67.9808 29.5575 -66.2201 23.8522 -64.2747 18.9326 -62.1832 14.6891 -59.976 11.0155 -57.6765 7.81747 -55.3028 5.0143 -52.8691 2.53966 -50.3861 0.33913 -47.8626 -1.6317 -45.305 -3.40871 -42.719 -5.02146 -40.1088 -6.49405 -37.4779 -7.84626 -34.8293 -9.09463 -32.1654 -10.2528 -29.4882 -11.3322 -26.7995 -12.3427 -24.1006 -13.2922 -21.3929 -14.1879 -18.6776 -15.0358 -15.9555 -15.8408 -13.2276 -16.6075 -10.4947 -17.3397 -7.75738 -18.0408 -5.01639 -18.7138 -2.27227 -19.3611 0.474428 -19.985 3.22322 -20.5876 5.97365 -21.1706 8.7253 -21.7355 11.4778 -22.2838 14.2308 -22.8166 16.9839 -23.3351 19.7369 -23.8401 22.4895 -24.3325 25.2414 -24.8129 27.9925 -25.2821 30.7425 -25.7405 33.4913 -26.1884 36.2388 -26.6261 38.9847 -27.0538 41.7291 -27.4715 44.4718 -27.8789 47.2129 -28.2758 49.9522 -28.6614 52.6898 -29.0348 55.4256 -29.3945 58.1598 -29.7384 60.8922 -30.0634 63.6231 -30.3651 66.3524 -30.6368 69.0802 -30.868 72.026 -31.035 74.7506 -31.1124 77.4736 -31.0433 80.1944 -30.707 82.9117 -29.798 85.6202 -27.2573 88.2797 -15.4 89.3932 67.9659";
      footprintStub(footprint, "SLSTR l2 pac v4");
   }

   @Test
   public void testSlstrL2PAC_v5()
   {
      String footprint = "89.5782 -113.911 89.7521 163.389 89.4013 118.77 88.9624 110.134 88.5132 106.417 88.0606 104.425 87.6065 103.188 87.1515 102.345 86.6882 101.588 86.2349 101.178 85.7845 100.915 85.3285 100.623 84.8649 100.351 84.4157 100.106 83.9594 99.9427 83.5036 99.7924 83.04 99.7283 82.5827 99.6051 82.1313 99.5053 81.6742 99.4126 81.218 99.3244 80.761 99.2392 80.3002 99.2226 79.8457 99.146 79.3923 99.0689 78.9397 99.0372 78.4807 99.0045 78.0223 98.967 77.5611 98.9248 77.1104 98.8945 76.9318 98.8882 76.7744 107.004 76.0652 118.736 74.8648 129.012 73.2784 137.612 71.4044 144.662 69.3207 150.416 67.0839 155.142 64.7347 159.064 62.3012 162.362 59.8037 165.172 57.2565 167.597 54.6701 169.716 52.0523 171.587 49.4091 173.256 46.7449 174.76 44.0632 176.126 41.3668 177.378 38.6579 178.532 35.9383 179.603 33.2096 -179.396 30.4729 -178.456 27.7294 -177.569 24.98 -176.727 22.2254 -175.925 19.4663 -175.157 16.7035 -174.419 13.9375 -173.708 11.1687 -173.02 8.39776 -172.353 5.62503 -171.702 2.85094 -171.067 0.075887 -170.445 -2.69977 -169.833 -5.47568 -169.231 -8.25152 -168.635 -11.027 -168.045 -13.8018 -167.459 -16.5757 -166.875 -19.3483 -166.291 -22.1196 -165.705 -24.8892 -165.115 -27.6569 -164.52 -30.4225 -163.917 -33.1859 -163.303 -35.9468 -162.675 -38.705 -162.029 -41.4604 -161.362 -44.2127 -160.668 -46.9618 -159.941 -49.7073 -159.174 -52.4489 -158.355 -55.1862 -157.473 -57.9187 -156.509 -60.6455 -155.442 -63.3657 -154.236 -66.0776 -152.846 -68.7787 -151.2 -71.4651 -149.188 -74.1301 -146.626 -76.7617 -143.19 -79.3361 -138.257 -81.8002 -130.514 -84.0169 -116.92 -85.5969 -91.3412 -85.7569 -54.059 -84.374 -25.6554 -82.233 -10.4038 -79.8001 -1.89007 -77.2406 3.42909 -74.6173 7.08124 -71.9573 9.7738 -69.2743 11.8706 -66.5757 13.5738 -63.8656 15.0046 -61.147 16.2399 -58.4214 17.3303 -55.69 18.311 -52.9536 19.2068 -50.2129 20.0359 -47.4683 20.8121 -44.72 21.5458 -41.9684 22.2452 -39.2138 22.9167 -36.4562 23.5658 -33.696 24.1967 -30.9333 24.8132 -28.1683 25.4183 -25.4011 26.0149 -22.6321 26.6052 -19.8614 27.1915 -17.0891 27.7758 -14.3157 28.3599 -11.5413 28.9456 -8.76614 29.5347 -5.99058 30.1288 -3.21489 30.7298 -0.439393 31.3394 2.33557 31.9596 5.10964 32.5922 7.88243 33.2395 10.6535 33.9039 13.4225 34.5878 16.1889 35.2943 18.9521 36.0265 21.7117 36.7882 24.467 37.5836 27.2173 38.4176 29.9618 39.296 32.6997 40.2255 35.4299 41.2141 38.1511 42.2714 40.862 43.4089 43.5607 44.6406 46.2453 45.9838 48.9129 47.46 51.5603 49.096 54.1831 50.926 56.7758 52.9936 59.331 55.3558 61.8388 58.0866 64.2855 61.284 66.6524 65.0774 68.9129 69.6365 71.0291 75.1791 72.9476 81.9652 74.595 90.2594 75.8757 100.225 76.6843 111.724 76.9328 124.142 77.1122 124.119 77.5687 124.192 78.0242 124.191 78.4821 124.274 78.9377 124.309 79.3915 124.341 79.8456 124.418 80.3019 124.441 80.7622 124.516 81.2195 124.594 81.6755 124.683 82.135 124.787 82.5915 124.887 83.0417 124.934 83.4965 125.056 83.9595 125.214 84.4155 125.377 84.8644 125.62 85.3281 125.875 85.78 126.086 86.2414 126.547 86.6962 126.976 87.1453 127.597 87.6047 128.328 88.0543 129.549 88.5088 131.462 88.9653 134.939 89.4008 144.699 89.7513 -171.015 89.5766 -88.7567 87.4685 24.6313 84.7569 28.4385 82.0357 29.3709 79.3117 29.6206 76.5863 29.6029 73.8596 29.4523 71.1317 29.2255 68.4025 28.9507 65.6721 28.6429 62.9402 28.3113 60.2068 27.9615 57.4719 27.5969 54.7353 27.2201 51.997 26.8325 49.2571 26.4353 46.5154 26.029 43.772 25.6141 41.027 25.1908 38.2803 24.759 35.5322 24.3187 32.7825 23.8696 30.0315 23.4114 27.2794 22.9437 24.5263 22.466 21.7723 21.9776 19.0178 21.4779 16.2629 20.966 13.5079 20.4412 10.7532 19.9022 7.99902 19.3481 5.24575 18.7776 2.49378 18.1891 -0.256474 17.5812 -3.00456 16.9519 -5.74998 16.2992 -8.49219 15.6207 -11.2306 14.9139 -13.9646 14.1757 -16.6934 13.4027 -19.4164 12.5908 -22.1325 11.7355 -24.8407 10.8316 -27.5401 9.87278 -30.2292 8.85187 -32.9066 7.76041 -35.5704 6.58835 -38.2187 5.32371 -40.849 3.95229 -43.4582 2.45681 -46.0426 0.816494 -48.598 -0.993922 -51.1185 -3.00565 -53.5971 -5.2566 -56.025 -7.7938 -58.3906 -10.6752 -60.6791 -13.9713 -62.8712 -17.7681 -64.9419 -22.1658 -66.859 -27.2762 -68.5811 -33.2121 -70.0582 -40.0604 -71.2325 -47.8431 -72.0444 -56.4628 -72.4441 -65.6632 -72.4032 -75.0473 -71.9247 -84.1673 -71.042 -92.6476 -69.8074 -100.261 -68.2811 -106.938 -66.5195 -112.714 -64.5714 -117.685 -62.4761 -121.964 -60.2645 -125.661 -57.9604 -128.875 -55.5823 -131.689 -53.1441 -134.169 -50.6571 -136.373 -48.1295 -138.345 -45.5683 -140.122 -42.9789 -141.734 -40.3654 -143.205 -37.7314 -144.556 -35.0799 -145.802 -32.4132 -146.959 -29.7334 -148.036 -27.0421 -149.045 -24.3408 -149.994 -21.6308 -150.888 -18.9131 -151.735 -16.1888 -152.539 -13.4588 -153.306 -10.7237 -154.038 -7.98426 -154.739 -5.24117 -155.413 -2.49498 -156.061 0.253778 -156.686 3.00462 -157.291 5.7571 -157.876 8.5108 -158.443 11.2653 -158.994 14.0204 -159.531 16.7755 -160.053 19.5306 -160.563 22.2853 -161.06 25.0393 -161.547 27.7925 -162.023 30.5446 -162.488 33.2955 -162.945 36.0451 -163.393 38.7931 -163.831 41.5397 -164.262 44.2845 -164.683 47.0277 -165.097 49.7692 -165.502 52.509 -165.897 55.247 -166.283 57.9834 -166.658 60.7182 -167.02 63.4514 -167.367 66.1831 -167.695 68.9133 -167.997 71.6423 -168.265 74.37 -168.481 77.0965 -168.613 79.8218 -168.596 82.5454 -168.268 85.2657 -167.095 87.9721 -161.692 89.5782 -113.911";
      footprintStub(footprint, "SLSTR LV2 pac v5");
   }

   @Test(enabled = false) // FIXME does not pass
   public void testSlstrL2PAC_v6()
   {
      // broken
      String footprint = "89.4036 -22.8116 89.9109 9.35862 89.4341 142.89 88.8653 146.566 88.2937 147.793 87.7214 148.404 87.1488 148.771 86.5761 149.015 86.0033 149.189 85.4304 149.319 84.8575 149.421 84.2845 149.502 83.7116 149.569 83.1385 149.624 82.5655 149.671 81.9925 149.711 81.4194 149.746 80.8463 149.777 80.2732 149.804 79.7 149.828 79.1269 149.849 78.5537 149.869 77.9805 149.886 77.4072 149.902 76.834 149.917 76.2607 149.93 75.6873 149.942 75.114 149.954 74.5406 149.964 73.9672 149.974 73.3938 149.983 72.8203 149.992 72.2468 150 72.1034 150.002 72.0192 155.967 71.5304 164.983 70.6436 173.327 69.4088 -179.166 67.8841 -172.566 66.1247 -166.841 64.1787 -161.901 62.0847 -157.639 59.8735 -153.949 57.5691 -150.737 55.1896 -147.922 52.7495 -145.436 50.2599 -143.227 47.7293 -141.248 45.1647 -139.465 42.5716 -137.847 39.9545 -136.37 37.3168 -135.014 34.6617 -133.762 31.9915 -132.602 29.3084 -131.52 26.6141 -130.508 23.9102 -129.557 21.1979 -128.661 18.4785 -127.813 15.7528 -127.008 13.0219 -126.242 10.2865 -125.51 7.54735 -124.81 4.80511 -124.138 2.06036 -123.492 -0.686344 -122.87 -3.4345 -122.269 -6.18365 -121.689 -8.93338 -121.126 -11.6833 -120.581 -14.4331 -120.052 -17.1824 -119.537 -19.9309 -119.036 -22.6784 -118.548 -25.4246 -118.072 -28.1694 -117.609 -30.9125 -117.156 -33.6539 -116.715 -36.3933 -116.285 -39.1307 -115.866 -41.866 -115.457 -44.5992 -115.06 -47.3302 -114.675 -50.059 -114.303 -52.7856 -113.945 -55.5101 -113.603 -58.2324 -113.28 -60.9528 -112.98 -63.6711 -112.708 -66.3875 -112.473 -69.102 -112.288 -71.8147 -112.174 -74.5254 -112.166 -77.2339 -112.331 -79.9396 -112.807 -82.6403 -113.933 -85.3291 -116.831 -87.9606 -128.451 -88.9108 115.311 -86.4091 85.1527 -83.7317 80.5081 -81.0343 78.894 -78.3303 78.2168 -75.6227 77.9493 -72.9128 77.8978 -70.2008 77.9745 -67.487 78.1341 -64.7712 78.3508 -62.0536 78.6089 -59.334 78.8984 -56.6123 79.2127 -53.8886 79.5473 -51.1627 79.8989 -48.4346 80.2655 -45.7044 80.6455 -42.9719 81.0377 -40.2373 81.4416 -37.5005 81.8566 -34.7617 82.2825 -32.021 82.7193 -29.2784 83.1671 -26.534 83.6262 -23.7882 84.0969 -21.0409 84.5797 -18.2926 85.0753 -15.5434 85.5845 -12.7936 86.1079 -10.0435 86.6467 -7.2934 87.2021 -4.54376 87.7751 -1.79495 88.3675 0.952602 88.9808 3.6984 89.6168 6.44193 90.2779 9.1826 90.9663 11.9198 91.6849 14.6528 92.4369 17.3809 93.226 20.1031 94.0562 22.8186 94.9325 25.5262 95.8606 28.2247 96.847 30.9127 97.8995 33.5885 99.0271 36.2501 100.241 38.8952 101.553 41.5212 102.979 44.1245 104.538 46.7013 106.252 49.2464 108.148 51.7535 110.26 54.2148 112.628 56.6202 115.303 58.9568 118.348 61.2081 121.835 63.3525 125.855 65.3622 130.509 67.2019 135.906 68.8272 142.146 70.1855 149.289 71.2191 157.314 71.8721 166.066 72.1032 175.24 72.2466 175.238 72.8201 175.23 73.3935 175.221 73.967 175.211 74.5404 175.201 75.1138 175.19 75.6871 175.178 76.2604 175.166 76.8337 175.152 77.407 175.137 77.9802 175.12 78.5534 175.102 79.1266 175.082 79.6998 175.06 80.2729 175.035 80.8461 175.007 81.4192 174.976 81.9922 174.939 82.5653 174.898 83.1383 174.849 83.7113 174.792 84.2843 174.724 84.8572 174.64 85.4302 174.535 86.003 174.4 86.5758 174.22 87.1486 173.968 87.7211 173.59 88.2934 172.958 88.865 171.692 89.4336 167.899 89.9099 35.592 89.4035 2.66392 87.1408 73.1967 84.4473 78.5869 81.7338 80.1798 79.0147 80.7829 76.2928 80.9835 73.569 80.9806 70.8437 80.8603 68.1168 80.6654 65.3885 80.4198 62.6585 80.1378 59.927 79.8281 57.1938 79.4969 54.4589 79.1478 51.7223 78.7837 48.984 78.4064 46.2438 78.0172 43.502 77.617 40.7584 77.2064 38.0132 76.7855 35.2664 76.3546 32.5182 75.9137 29.7686 75.4624 27.0179 75.0006 24.2662 74.5277 21.5136 74.0434 18.7605 73.5469 16.0071 73.0374 13.2536 72.5143 10.5003 71.9763 7.74773 71.4225 4.99607 70.8516 2.24578 70.262 -0.502726 69.6523 -3.24897 69.0205 -5.99245 68.3646 -8.73261 67.6821 -11.4688 66.9705 -14.2005 66.2266 -16.9268 65.447 -19.647 64.6275 -22.3601 63.7634 -25.0652 62.8495 -27.761 61.8793 -30.4462 60.8455 -33.1193 59.7394 -35.7784 58.5507 -38.4213 57.2673 -41.0456 55.8744 -43.648 54.3545 -46.2247 52.6864 -48.7712 50.8441 -51.2815 48.796 -53.7483 46.5033 -56.1623 43.9183 -58.5116 40.9826 -60.7809 37.6246 -62.9501 33.7589 -64.9936 29.2861 -66.8782 24.097 -68.5623 18.0863 -69.9953 11.1769 -71.1202 3.36269 -71.8798 -5.2414 -72.2271 -14.369 -72.1382 -23.6257 -71.6196 -32.583 -70.7054 -40.8903 -69.4487 -48.3439 -67.9074 -54.8833 -66.1365 -60.5493 -64.1831 -65.435 -62.0852 -69.649 -59.8728 -73.2977 -57.5691 -76.4752 -55.192 -79.261 -52.7554 -81.7211 -50.2701 -83.9095 -47.7445 -85.8699 -45.1853 -87.6382 -42.5978 -89.2434 -39.9863 -90.7095 -37.3543 -92.0562 -34.7047 -93.2996 -32.0399 -94.4535 -29.3619 -95.5291 -26.6724 -96.5362 -23.9729 -97.4828 -21.2646 -98.3758 -18.5487 -99.2212 -15.8261 -100.024 -13.0977 -100.789 -10.3644 -101.519 -7.62667 -102.219 -4.88531 -102.89 -2.14086 -103.536 0.606145 -104.158 3.35522 -104.76 6.1059 -105.342 8.85778 -105.906 11.6105 -106.453 14.3636 -106.985 17.1169 -107.502 19.8701 -108.006 22.6228 -108.498 25.3748 -108.977 28.126 -109.446 30.8761 -109.903 33.6249 -110.35 36.3724 -110.787 39.1184 -111.214 41.8628 -111.631 44.6055 -112.037 47.3466 -112.433 50.0859 -112.817 52.8234 -113.189 55.5592 -113.548 58.2933 -113.89 61.0257 -114.213 63.7565 -114.512 66.4857 -114.781 69.2134 -115.008 71.9397 -115.177 74.6644 -115.256 77.3874 -115.192 80.1083 -114.864 82.8257 -113.977 85.5346 -111.517 88.2122 -100.281 89.4036 -22.8116";
      footprintStub(footprint, "SLSTR LV2 pac v6 winter");
   }

   @Test
   public void testSlstrL2Pac_v7()
   {
      String footprint = "89.3932 67.9659 89.8556 138.166 89.4189 -139.854 88.8564 -132.845 88.2871 -130.448 87.7159 -129.245 87.144 -128.522 86.5717 -128.04 85.9992 -127.696 85.4265 -127.438 84.8538 -127.237 84.281 -127.077 83.7081 -126.945 83.1352 -126.835 82.5623 -126.743 81.9893 -126.663 81.4163 -126.594 80.8433 -126.533 80.2702 -126.48 79.6971 -126.432 79.124 -126.39 78.5508 -126.351 77.9776 -126.317 77.4044 -126.285 76.8312 -126.256 76.2579 -126.229 75.6846 -126.205 75.1113 -126.182 74.5379 -126.161 73.9645 -126.142 73.3911 -126.124 72.8176 -126.107 72.2442 -126.091 72.1008 -126.087 72.0238 -120.121 71.5501 -111.141 70.6752 -102.774 69.4507 -95.2394 67.9344 -88.6116 66.1818 -82.8603 64.2412 -77.8972 61.9759 -73.3102 59.7598 -69.6455 57.4515 -66.4539 55.0689 -63.6555 52.6263 -61.1847 50.1346 -58.987 47.6024 -57.0185 45.0365 -55.2434 42.4422 -53.6322 39.8241 -52.1612 37.1857 -50.8103 34.5299 -49.5633 31.8592 -48.4065 29.1757 -47.3283 26.481 -46.3193 23.7768 -45.3711 21.0643 -44.477 18.3447 -43.6308 15.619 -42.8275 12.888 -42.0626 10.1525 -41.3323 7.4134 -40.6333 4.6712 -39.9626 1.92652 -39.3177 -0.820084 -38.6964 -3.56812 -38.0966 -6.31712 -37.5166 -9.06669 -36.9549 -11.8164 -36.4101 -14.566 -35.881 -17.3151 -35.3667 -20.0634 -34.8661 -22.8106 -34.3785 -25.5566 -33.9032 -28.3011 -33.4397 -31.044 -32.9876 -33.7851 -32.5465 -36.5243 -32.1163 -39.2614 -31.697 -41.9965 -31.2887 -44.7294 -30.8917 -47.4601 -30.5067 -50.1887 -30.1346 -52.9151 -29.7766 -55.6394 -29.4348 -58.3615 -29.1119 -61.0816 -28.8118 -63.7998 -28.5403 -66.516 -28.3058 -69.2304 -28.1215 -71.9429 -28.0087 -74.6535 -28.0038 -77.3619 -28.1748 -80.0674 -28.6634 -82.7679 -29.8241 -85.456 -32.8484 -88.0815 -45.4789 -88.817 -164.905 -86.2853 168.83 -83.6057 164.486 -80.9077 162.956 -78.2033 162.313 -75.4955 162.065 -72.7854 162.024 -70.0733 162.109 -67.3593 162.273 -64.6434 162.494 -61.9256 162.755 -59.2059 163.047 -56.484 163.363 -53.7601 163.7 -51.034 164.053 -48.3058 164.421 -45.5753 164.802 -42.8427 165.195 -40.1078 165.6 -37.3709 166.016 -34.6318 166.443 -31.8909 166.881 -29.148 167.33 -26.4035 167.79 -23.6574 168.261 -20.9099 168.745 -18.1614 169.242 -15.4119 169.752 -12.6619 170.276 -9.91163 170.816 -7.16139 171.373 -4.41159 171.947 -1.66264 172.541 1.08503 173.155 3.83093 173.793 6.57451 174.455 9.31522 175.146 12.0524 175.866 14.7854 176.62 17.5133 177.411 20.2355 178.244 22.9507 179.123 25.6581 -179.946 28.3563 -178.956 31.0438 -177.899 33.719 -176.768 36.38 -175.549 39.0244 -174.231 41.6494 -172.798 44.2516 -171.232 46.827 -169.509 49.3703 -167.602 51.8754 -165.478 54.3342 -163.095 56.7364 -160.402 59.0691 -157.337 61.3154 -153.824 63.4536 -149.775 65.4556 -145.086 67.2853 -139.648 68.8982 -133.363 70.2413 -126.174 71.2565 -118.109 71.889 -109.329 72.0977 -100.146 72.2411 -100.144 72.8146 -100.137 73.3881 -100.13 73.9616 -100.122 74.535 -100.113 75.1083 -100.104 75.6817 -100.094 76.255 -100.083 76.8283 -100.071 77.4016 -100.058 77.9748 -100.044 78.548 -100.029 79.1212 -100.012 79.6944 -99.9929 80.2675 -99.9718 80.8407 -99.9481 81.4138 -99.9213 81.9869 -99.8907 82.5599 -99.8554 83.133 -99.8142 83.706 -99.7656 84.279 -99.7073 84.8519 -99.6361 85.4249 -99.5471 85.9978 -99.4327 86.5706 -99.2801 87.1434 -99.0665 87.716 -98.7459 88.2884 -98.2112 88.8602 -97.1415 89.4296 -93.9489 89.9156 44.1383 89.4102 73.4717 87.2771 156.879 84.5853 162.653 81.8719 164.313 79.1527 164.937 76.4308 165.146 73.7069 165.147 70.9814 165.028 68.2545 164.834 65.526 164.589 62.796 164.307 60.0643 163.998 57.3311 163.666 54.5961 163.317 51.8593 162.953 49.1209 162.576 46.3806 162.187 43.6387 161.786 40.895 161.376 38.1497 160.955 35.4028 160.524 32.6544 160.083 29.9047 159.632 27.1538 159.17 24.4019 158.698 21.6492 158.214 18.8959 157.717 16.1423 157.208 13.3886 156.685 10.6352 156.148 7.88235 155.595 5.13045 155.024 2.3799 154.435 -0.368877 153.826 -3.11541 153.195 -5.8592 152.54 -8.59969 151.859 -11.3363 151.148 -14.0683 150.406 -16.795 149.628 -19.5157 148.81 -22.2293 147.948 -24.9349 147.036 -27.6312 146.068 -30.3171 145.037 -32.9908 143.934 -35.6506 142.749 -38.2944 141.47 -40.9196 140.082 -43.5231 138.569 -46.1012 136.907 -48.6491 135.074 -51.1612 133.036 -53.6301 130.755 -56.0468 128.184 -58.3993 125.266 -60.6725 121.929 -62.8467 118.089 -64.8965 113.647 -66.7892 108.494 -68.4834 102.525 -69.9291 95.6594 -71.0696 87.8882 -71.8472 79.3184 -72.2146 70.2102 -72.1465 60.9526 -71.6475 51.9752 -70.7513 43.6333 -69.5096 36.1387 -67.9808 29.5575 -66.2201 23.8522 -64.2747 18.9326 -62.1832 14.6891 -59.976 11.0155 -57.6765 7.81747 -55.3028 5.0143 -52.8691 2.53966 -50.3861 0.33913 -47.8626 -1.6317 -45.305 -3.40871 -42.719 -5.02146 -40.1088 -6.49405 -37.4779 -7.84626 -34.8293 -9.09463 -32.1654 -10.2528 -29.4882 -11.3322 -26.7995 -12.3427 -24.1006 -13.2922 -21.3929 -14.1879 -18.6776 -15.0358 -15.9555 -15.8408 -13.2276 -16.6075 -10.4947 -17.3397 -7.75738 -18.0408 -5.01639 -18.7138 -2.27227 -19.3611 0.474428 -19.985 3.22322 -20.5876 5.97365 -21.1706 8.7253 -21.7355 11.4778 -22.2838 14.2308 -22.8166 16.9839 -23.3351 19.7369 -23.8401 22.4895 -24.3325 25.2414 -24.8129 27.9925 -25.2821 30.7425 -25.7405 33.4913 -26.1884 36.2388 -26.6261 38.9847 -27.0538 41.7291 -27.4715 44.4718 -27.8789 47.2129 -28.2758 49.9522 -28.6614 52.6898 -29.0348 55.4256 -29.3945 58.1598 -29.7384 60.8922 -30.0634 63.6231 -30.3651 66.3524 -30.6368 69.0802 -30.868 72.026 -31.035 74.7506 -31.1124 77.4736 -31.0433 80.1944 -30.707 82.9117 -29.798 85.6202 -27.2573 88.2797 -15.4 89.3932 67.9659";
      footprintStub(footprint, "SLSTR LV2 pac v7");
   }

   @Test
   public void testOlciReduced()
   {
      String footprint = "-45.4529 41.7181 -45.718 42.5193 -45.9668 43.3348 -46.2097 44.1576 -46.4465 44.9876 -46.6773 45.8246 -46.9019 46.6688 -47.1202 47.5197 -47.3322 48.3777 -47.5377 49.2424 -47.7344 50.1157 -47.9266 50.9935 -48.1122 51.8778 -48.2921 52.7677 -48.4638 53.6644 -48.6285 54.567 -48.7862 55.4761 -48.9364 56.3902 -49.0794 57.3096 -49.2046 58.2371 -48.1908 58.5687 -46.3971 59.1346 -44.6007 59.6769 -42.8024 60.1983 -41.0035 60.7026 -39.2019 61.1902 -37.3988 61.6639 -35.5945 62.1257 -33.7887 62.5759 -31.9816 63.0171 -30.1733 63.4496 -28.3641 63.875 -26.5527 64.2933 -24.7417 64.707 -22.9299 65.1159 -21.1155 65.52 -19.3014 65.9211 -17.4874 66.3201 -15.6704 66.7159 -13.8547 67.1113 -12.0381 67.5054 -10.221 67.8991 -8.40348 68.293 -6.58502 68.6874 -4.76847 69.0837 -2.94921 69.4809 -1.1312 69.8807 0.68683 70.2833 2.50458 70.6892 4.3216 71.0993 6.13974 71.5132 7.95658 71.9326 9.77319 72.3576 11.5882 72.7892 13.4026 73.2282 15.2174 73.6745 17.0297 74.1297 18.8418 74.5947 20.6522 75.07 22.4612 75.5572 24.269 76.0572 26.0744 76.5715 27.8785 77.1007 29.6799 77.6474 31.4792 78.2128 33.2764 78.7986 35.0705 79.4073 36.8613 80.0418 38.6491 80.7037 40.4328 81.397 42.2128 82.1249 43.9882 82.8915 45.7582 83.7018 47.5233 84.5607 49.2816 85.4745 51.0326 86.4513 52.7758 87.499 54.51 88.6281 56.2335 89.8509 57.9452 91.181 59.6425 92.6366 61.3231 94.2389 62.9851 96.0128 64.6231 97.9907 66.2336 100.209 67.8098 102.716 69.3451 105.569 70.8293 108.839 72.2487 112.61 73.5876 116.981 74.8251 122.062 75.9329 127.955 76.8792 134.741 77.628 142.437 78.1406 150.932 78.3861 159.973 78.3473 169.172 78.0271 178.1 77.4472 -173.603 76.6411 -166.149 75.647 -159.608 74.5008 -153.946 73.2338 -149.069 71.871 -144.871 70.4325 -141.244 68.9339 -138.095 67.3865 -135.342 67.7207 -133.975 68.0349 -132.556 68.3362 -131.101 68.6246 -129.608 68.8989 -128.076 69.1591 -126.507 69.4028 -124.899 69.6331 -123.256 69.8477 -121.579 70.0487 -119.87 70.2306 -118.127 70.3952 -116.356 70.5429 -114.56 70.6718 -112.74 70.7825 -110.897 70.8747 -109.032 70.9479 -107.151 71.0019 -105.259 71.026 -103.351 72.8116 -103.567 74.5964 -103.77 76.3808 -103.956 78.1651 -104.118 79.9488 -104.243 81.732 -104.303 83.5152 -104.255 85.2976 -103.967 87.079 -103.008 88.8548 -98.2399 89.3296 59.0267 87.5613 69.104 85.7807 70.4755 83.9983 70.8759 82.2156 70.9676 80.4324 70.9272 78.6485 70.818 76.8646 70.6652 75.0802 70.4845 73.2952 70.2862 71.51 70.0735 69.7244 69.85 67.9381 69.6191 66.1514 69.3801 64.3639 69.1375 62.5759 68.889 60.7874 68.637 58.9982 68.3818 57.2083 68.1225 55.4176 67.8602 53.6263 67.5951 51.8344 67.3265 50.0417 67.056 48.248 66.7824 46.454 66.5057 44.659 66.2265 42.8633 65.9444 41.0671 65.6592 39.2699 65.3713 37.4724 65.0799 35.674 64.7857 33.8748 64.4885 32.0755 64.1874 30.2754 63.8828 28.4746 63.575 26.6738 63.2627 24.8721 62.9468 23.0703 62.6266 21.2682 62.3021 19.4659 61.9728 17.6634 61.6386 15.8603 61.2997 14.0581 60.9547 12.2557 60.6041 10.453 60.248 8.65088 59.8852 6.84878 59.5163 5.04769 59.1395 3.24674 58.7555 1.44662 58.3635 -0.352621 57.9632 -2.1516 57.5543 -3.94827 57.1348 -5.74491 56.7061 -7.53977 56.2663 -9.33304 55.815 -11.1246 55.3514 -12.9143 54.8742 -14.7028 54.3842 -16.4877 53.8776 -18.2709 53.3556 -20.0517 52.8164 -21.8287 52.2576 -23.6028 51.6784 -25.3739 51.0784 -27.1405 50.4539 -28.9031 49.8039 -30.6611 49.1257 -32.4142 48.4177 -34.1616 47.6757 -35.9031 46.8979 -37.638 46.0803 -39.365 45.2182 -41.0847 44.309 -42.7953 43.3462 -44.4957 42.3245 -45.4529 41.7181";
      footprintStub(footprint, "Olci reduced 1");
   }

   @Test
   public void testOlciReduced2()
   {
      String footprint = "-45.2582 118.515 -45.5221 119.313 -45.77 120.126 -46.0121 120.946 -46.2482 121.774 -46.4783 122.608 -46.7022 123.45 -46.9198 124.298 -47.1311 125.153 -47.336 126.015 -47.5322 126.886 -47.7239 127.76 -47.909 128.642 -48.0885 129.528 -48.2598 130.422 -48.4242 131.321 -48.5816 132.226 -48.7316 133.137 -48.8743 134.053 -48.9994 134.976 -48.0473 135.287 -46.2527 135.851 -44.4563 136.391 -42.6583 136.912 -40.8584 137.414 -39.0564 137.901 -37.2535 138.374 -35.4489 138.835 -33.6429 139.285 -31.8356 139.725 -30.0272 140.157 -28.2172 140.582 -26.4066 141 -24.5951 141.414 -22.7822 141.822 -20.9687 142.226 -19.1541 142.627 -17.3387 143.026 -15.5229 143.422 -13.7071 143.817 -11.8901 144.212 -10.0721 144.605 -8.25525 145 -6.43708 145.394 -4.6181 145.79 -2.80046 146.188 -0.982076 146.588 0.835913 146.991 2.65422 147.398 4.47164 147.808 6.28942 148.223 8.10627 148.643 9.92291 149.068 11.7387 149.501 13.5523 149.94 15.3669 150.388 17.1809 150.843 18.9917 151.31 20.8024 151.786 22.6116 152.274 24.4192 152.775 26.2247 153.291 28.0282 153.822 29.8302 154.37 31.6296 154.938 33.4261 155.525 35.2202 156.136 37.0111 156.773 38.7979 157.438 40.5823 158.134 42.362 158.865 44.137 159.636 45.9066 160.45 47.6704 161.314 49.4289 162.233 51.1799 163.216 52.9219 164.27 54.6545 165.407 56.3784 166.638 58.0881 167.979 59.7843 169.447 61.4641 171.063 63.1234 172.853 64.7596 174.85 66.3674 177.092 67.9408 179.626 69.472 -177.487 70.9506 -174.178 72.364 -170.359 73.6943 -165.932 74.9219 -160.786 76.0182 -154.819 76.9483 -147.954 77.6787 -140.184 78.1689 -131.634 78.3903 -122.565 78.3271 -113.376 77.9839 -104.49 77.3832 -96.2623 76.5599 -88.8869 75.5513 -82.4241 74.3939 -76.8323 73.1181 -72.0191 71.7482 -67.8737 70.3039 -64.2895 68.8008 -61.178 67.2501 -58.4555 67.5826 -57.0932 67.8949 -55.6817 68.1948 -54.2326 68.4818 -52.7461 68.7547 -51.2215 69.0132 -49.6618 69.2548 -48.0692 69.483 -46.4438 69.6955 -44.7854 69.8948 -43.0968 70.075 -41.3771 70.2383 -39.6299 70.385 -37.8589 70.5139 -36.0562 70.6248 -34.2319 70.7174 -32.3853 70.7916 -30.5122 70.8468 -28.622 70.8727 -26.6681 72.6584 -26.886 74.4434 -27.091 76.2281 -27.2821 78.0122 -27.448 79.7959 -27.5784 81.5793 -27.6525 83.3626 -27.6213 85.1454 -27.3763 86.9263 -26.535 88.7042 -22.6719 89.4772 132.005 87.7139 145.633 85.9333 147.133 84.1506 147.567 82.3682 147.664 80.5846 147.631 78.8007 147.524 77.0169 147.369 75.2322 147.189 73.4476 146.989 71.6621 146.776 69.8764 146.553 68.0902 146.322 66.3031 146.084 64.5162 145.84 62.7281 145.592 60.9391 145.34 59.15 145.083 57.3597 144.825 55.5695 144.562 53.7781 144.296 51.9858 144.028 50.1931 143.758 48.3997 143.484 46.6054 143.207 44.8105 142.928 43.0145 142.646 41.2178 142.361 39.4218 142.073 37.6233 141.782 35.8248 141.488 34.0261 141.19 32.2262 140.889 30.4257 140.585 28.6256 140.277 26.8247 139.965 25.0224 139.649 23.2205 139.33 21.4184 139.005 19.6162 138.676 17.8131 138.342 16.0102 138.004 14.2079 137.659 12.4049 137.309 10.6023 136.953 8.80015 136.59 6.99782 136.222 5.19637 135.846 3.39532 135.462 1.59463 135.071 -0.204223 134.671 -2.0032 134.262 -3.8013 133.844 -5.59746 133.416 -7.39234 132.977 -9.18655 132.527 -10.9785 132.064 -12.7682 131.588 -14.5563 131.098 -16.3424 130.593 -18.1258 130.073 -19.9064 129.534 -21.6846 128.977 -23.4587 128.4 -25.2297 127.801 -26.9976 127.179 -28.7603 126.53 -30.5187 125.855 -32.2725 125.149 -34.0204 124.409 -35.762 123.634 -37.498 122.82 -39.2261 121.962 -40.9462 121.056 -42.6577 120.097 -44.3586 119.081 -45.2582 118.515";
      footprintStub(footprint, "Olci reduced 2");
   }

   @Test
   public void testOlciReduced4()
   {
      String footprint = "-45.1815 25.9996 -45.4452 26.7977 -45.6927 27.6101 -45.9344 28.4296 -46.1701 29.2561 -46.3997 30.0897 -46.6233 30.9301 -46.8405 31.7773 -47.0515 32.6313 -47.256 33.492 -47.4518 34.361 -47.6433 35.2345 -47.8281 36.1144 -48.0073 36.9997 -48.1784 37.8917 -48.3425 38.7895 -48.4997 39.6937 -48.6495 40.6027 -48.7921 41.517 -48.9171 42.4392 -47.1855 42.996 -45.401 43.5457 -43.6138 44.073 -41.8254 44.5817 -40.0353 45.074 -38.2434 45.5513 -36.4499 46.0156 -34.655 46.4685 -32.8593 46.9117 -31.0614 47.3458 -29.2634 47.772 -27.4641 48.1918 -25.6626 48.6049 -23.8616 49.0138 -22.0592 49.418 -20.2552 49.8182 -18.4515 50.216 -16.646 50.6108 -14.8411 51.0048 -13.0358 51.3975 -11.2287 51.7886 -9.42178 52.1802 -7.61458 52.572 -5.80735 52.9649 -3.99955 53.3591 -2.19146 53.7549 -0.384669 54.154 1.42321 54.5554 3.23075 54.9605 5.03777 55.3696 6.84401 55.7835 8.65053 56.2025 10.4561 56.6275 12.2612 57.059 14.065 57.4981 15.8681 57.9452 17.6701 58.4011 19.4709 58.8672 21.2712 59.3434 23.069 59.8319 24.865 60.3341 26.6604 60.8496 28.4528 61.3815 30.2432 61.9308 32.0324 62.4988 33.8174 63.0881 35.6001 63.701 37.3805 64.3391 39.1567 65.006 40.9294 65.7044 42.6973 66.4387 44.4617 67.2118 46.22 68.0297 47.9731 68.8972 49.7202 69.821 51.4585 70.8092 53.1897 71.8694 54.9123 73.0123 56.6232 74.2514 58.3214 75.6006 60.0056 77.078 61.6744 78.7041 63.3208 80.5078 64.9447 82.5186 66.5401 84.7761 68.1002 87.3297 69.6181 90.2376 71.0828 93.5713 72.4819 97.4157 73.7977 101.872 75.0091 107.046 76.088 113.039 77.003 119.926 77.7162 127.703 78.1895 136.24 78.3968 145.275 78.3225 154.412 77.9712 163.228 77.3668 171.389 76.543 178.701 75.537 -174.889 74.3846 -169.339 73.1149 -164.558 71.7525 -160.438 70.3168 -156.872 68.8225 -153.774 67.2813 -151.062 67.6149 -149.695 67.9281 -148.279 68.2277 -146.831 68.5146 -145.345 68.7873 -143.821 69.0461 -142.259 69.2885 -140.66 69.5182 -139.022 69.7318 -137.353 69.932 -135.652 70.113 -133.919 70.277 -132.157 70.4241 -130.371 70.5528 -128.558 70.6632 -126.724 70.7551 -124.87 70.8281 -123.002 70.8821 -121.122 70.9063 -119.228 72.6815 -119.443 74.4564 -119.646 76.2306 -119.835 78.0047 -119.997 79.7786 -120.124 81.5515 -120.196 83.3246 -120.161 85.0971 -119.915 86.8683 -119.09 88.6357 -115.436 89.5503 35.9756 87.8021 52.8389 86.033 54.4714 84.2602 54.9492 82.4872 55.0765 80.7145 55.0506 78.9411 54.9498 77.1673 54.8027 75.3932 54.6283 73.6187 54.4326 71.8437 54.2229 70.0683 54.0019 68.2924 53.7742 66.5156 53.539 64.7397 53.2963 62.9611 53.0527 61.1829 52.8026 59.4045 52.5486 57.6249 52.2914 55.8444 52.0323 54.0636 51.7693 52.2826 51.5023 50.5002 51.234 48.7168 50.9627 46.9333 50.6881 45.1487 50.4118 43.3638 50.1314 41.5778 49.849 39.7915 49.5634 38.0042 49.2753 36.2164 48.9833 34.4282 48.6883 32.6387 48.3906 30.8494 48.0888 29.0595 47.7834 27.2682 47.475 25.4784 47.1616 23.6868 46.8447 21.8942 46.524 20.1028 46.198 18.3105 45.8675 16.5186 45.532 14.7268 45.1912 12.9338 44.8451 11.1418 44.493 9.34976 44.1351 7.55846 43.7703 5.76721 43.3988 3.97641 43.0201 2.18585 42.6338 0.397717 42.2389 -1.39132 41.836 -3.1793 41.4236 -4.96543 41.0014 -6.75057 40.569 -8.53424 40.1254 -10.3177 39.6703 -12.0969 39.2021 -13.8742 38.7203 -15.6517 38.2246 -17.4249 37.7131 -19.1972 37.1852 -20.9659 36.6391 -22.7311 36.0734 -24.4938 35.4877 -26.2522 34.8788 -28.0068 34.2456 -29.7572 33.5861 -31.5022 32.8975 -33.2431 32.1777 -34.9779 31.4238 -36.7063 30.6325 -38.4277 29.7997 -40.1417 28.922 -41.8477 27.9946 -43.5433 27.0121 -45.1815 25.9996";
      footprintStub(footprint, "Olci reduced 4");
   }

   @Test
   public void testOlciReduced5()
   {
      String footprint = "-45.3569 -175.154 -45.6214 -174.355 -45.8697 -173.54 -46.1122 -172.719 -46.3487 -171.89 -46.5792 -171.054 -46.8034 -170.211 -47.0214 -169.361 -47.2331 -168.505 -47.4383 -167.642 -47.6347 -166.77 -47.8267 -165.893 -48.012 -165.011 -48.1918 -164.122 -48.3633 -163.227 -48.5278 -162.326 -48.6854 -161.419 -48.8355 -160.506 -48.9784 -159.589 -49.1035 -158.663 -47.4347 -158.123 -45.6495 -157.57 -43.8621 -157.04 -42.0743 -156.529 -40.2843 -156.034 -38.4925 -155.555 -36.6991 -155.089 -34.9043 -154.634 -33.1092 -154.189 -31.3112 -153.754 -29.5123 -153.327 -27.714 -152.906 -25.9129 -152.492 -24.1107 -152.083 -22.3084 -151.678 -20.5051 -151.277 -18.7014 -150.879 -16.8967 -150.483 -15.0902 -150.089 -13.2851 -149.697 -11.4779 -149.305 -9.67116 -148.913 -7.86424 -148.521 -6.05643 -148.129 -4.24799 -147.735 -2.44122 -147.339 -0.63457 -146.94 1.17512 -146.54 2.98188 -146.135 4.7886 -145.726 6.5963 -145.313 8.40204 -144.894 10.2076 -144.47 12.0131 -144.04 13.8183 -143.602 15.6203 -143.156 17.4224 -142.701 19.2241 -142.236 21.0246 -141.761 22.8226 -141.274 24.6193 -140.774 26.4144 -140.26 28.2076 -139.731 29.9986 -139.184 31.7863 -138.618 33.574 -138.032 35.3565 -137.423 37.1363 -136.788 38.9141 -136.125 40.6873 -135.431 42.4561 -134.702 44.2204 -133.934 45.9799 -133.122 47.7341 -132.262 49.4813 -131.346 51.2212 -130.367 52.9544 -129.318 54.677 -128.186 56.3896 -126.961 58.0904 -125.628 59.7766 -124.169 61.4465 -122.563 63.097 -120.785 64.7242 -118.806 66.3234 -116.583 67.8891 -114.073 69.413 -111.218 70.8856 -107.947 72.2948 -104.176 73.623 -99.81 74.8491 -94.7415 75.9487 -88.8638 76.8879 -82.1015 77.63 -74.4447 78.1383 -65.9986 78.3832 -57.0107 78.3477 -47.8607 78.0328 -38.9856 77.4609 -30.7239 76.6652 -23.2843 75.6822 -16.7548 74.5476 -11.0924 73.2926 -6.21202 71.942 -2.00937 70.5152 1.62557 69.0285 4.78281 67.4932 7.5427 67.8288 8.91408 68.1441 10.3358 68.447 11.7963 68.7368 13.2954 69.0125 14.8338 69.274 16.4102 69.5188 18.0244 69.7501 19.6742 69.9649 21.3531 70.1678 23.0781 70.35 24.8247 70.5159 26.6109 70.6642 28.4169 70.7939 30.2509 70.9051 32.1072 70.9975 33.9825 71.0708 35.8736 71.1248 37.777 71.1488 39.695 72.9237 39.4816 74.6985 39.2794 76.473 39.0941 78.2467 38.9352 80.0203 38.8113 81.7934 38.7492 83.5662 38.8008 85.3389 39.0783 87.1098 40.0443 88.8753 44.8973 89.3199 -157.506 87.5616 -147.773 85.791 -146.436 84.0188 -146.043 82.246 -145.948 80.4727 -145.986 78.6996 -146.099 76.9257 -146.251 75.1513 -146.43 73.377 -146.629 71.6019 -146.841 69.8263 -147.062 68.0506 -147.293 66.2737 -147.529 64.4967 -147.771 62.719 -148.018 60.9408 -148.269 59.1619 -148.523 57.382 -148.78 55.6019 -149.041 53.8208 -149.304 52.0394 -149.571 50.2569 -149.84 48.4736 -150.112 46.6897 -150.387 44.9053 -150.664 43.1202 -150.945 41.3342 -151.228 39.5471 -151.513 37.7601 -151.803 35.9723 -152.095 34.1831 -152.39 32.3944 -152.689 30.6046 -152.991 28.8144 -153.297 27.0237 -153.606 25.2326 -153.92 23.4413 -154.238 21.6493 -154.559 19.857 -154.885 18.065 -155.217 16.273 -155.554 14.4802 -155.895 12.6879 -156.242 10.8959 -156.595 9.10393 -156.954 7.31192 -157.319 5.52106 -157.692 3.73048 -158.072 1.93816 -158.459 0.150357 -158.855 -1.63633 -159.26 -3.42474 -159.674 -5.21189 -160.097 -6.99653 -160.531 -8.77994 -160.976 -10.5626 -161.433 -12.3424 -161.904 -14.1209 -162.386 -15.897 -162.885 -17.6706 -163.399 -19.442 -163.929 -21.21 -164.478 -22.9757 -165.046 -24.7375 -165.635 -26.4951 -166.248 -28.2499 -166.885 -30.0009 -167.548 -31.744 -168.241 -33.4834 -168.965 -35.2178 -169.724 -36.9455 -170.521 -38.666 -171.36 -40.3788 -172.245 -42.0838 -173.179 -43.7789 -174.17 -45.3569 -175.154";
      footprintStub(footprint, "Olci reduced 5");
   }

   @Test
   public void testSlstrNorthPole2()
   {
      String footprint = "84.1451 -147.971 84.1484 -143.492 84.1069 -138.971 84.0448 -134.635 83.9482 -130.393 83.8139 -126.285 83.6526 -122.382 83.4622 -118.682 83.246 -115.205 82.9975 -111.941 82.7428 -108.889 82.4683 -106.113 82.166 -103.482 81.8614 -101.084 81.5386 -98.8496 81.1975 -96.7592 80.8531 -94.8524 80.4956 -93.0708 80.1369 -91.4496 79.7659 -89.9235 79.3883 -88.5126 79.0039 -87.1977 78.6155 -85.9174 78.2212 -84.7809 77.83 -83.6902 77.4281 -82.6763 77.0227 -81.7242 76.6147 -80.8455 76.1965 -79.9927 75.7783 -79.2098 75.6249 -78.8914 76.5095 -68.3805 76.9168 -56.6503 76.7822 -44.6809 76.1215 -33.3891 76.2904 -33.1385 76.7198 -32.4705 77.1582 -31.7651 77.5729 -30.9989 78.002 -30.2026 78.4174 -29.314 78.8325 -28.4059 79.2453 -27.3924 79.6582 -26.2911 80.0687 -25.1564 80.4704 -23.8806 80.8683 -22.485 81.2561 -20.9941 81.6417 -19.3518 82.0248 -17.5071 82.3933 -15.5262 82.7531 -13.352 83.1018 -10.9385 83.4387 -8.34464 83.7562 -5.36138 84.0534 -2.19317 84.343 1.36947 84.5962 5.24262 84.8328 9.54973 85.0289 14.1718 85.1941 19.1967 85.3109 24.5928 85.3934 30.1371 85.4402 35.6981 85.4232 41.558 88.0163 47.077 89.2443 -172.06 86.7053 -150.319 84.1451 -147.971";
      footprintStub(footprint, "Slstr north pole 2");
   }

   @Test
   public void testSralL0ST()
   {
      String footprint = "-31.8656 -74.3954 -31.8656 -76.0655 -36.7693 -77.619 -42.8872 -79.0066 -50.5816 -80.1581 -60.2112 -80.9827 -71.9206 -80.9844 -71.9172 -80.1597 -60.2061 -79.008 -50.5759 -77.6203 -42.8812 -76.0666 -36.7635 -74.3964 -31.8601 -74.3954";
      footprintStub(footprint, "SRAL L0 ST");
   }

   @Test
   public void testOlciReduced3()
   {
      String footprint = "-45.2753 168.996 -45.544 169.81 -45.7887 170.613 -46.0295 171.429 -46.2657 172.257 -46.4958 173.091 -46.7198 173.933 -46.9374 174.782 -47.1488 175.637 -47.3538 176.499 -47.55 177.37 -47.7418 178.245 -47.9269 179.126 -48.1064 -179.987 -48.2778 -179.093 -48.4422 -178.194 -48.5997 -177.288 -48.7497 -176.377 -48.8925 -175.461 -49.0176 -174.537 -48.065 -174.227 -46.2706 -173.662 -44.4739 -173.122 -42.6762 -172.601 -40.876 -172.098 -39.0748 -171.611 -37.2722 -171.137 -35.4663 -170.677 -33.6609 -170.227 -31.8532 -169.787 -30.0454 -169.354 -28.2359 -168.929 -26.4243 -168.511 -24.6136 -168.097 -22.7998 -167.69 -20.9863 -167.285 -19.1728 -166.884 -17.3571 -166.485 -15.5413 -166.089 -13.7256 -165.694 -11.9076 -165.3 -10.0912 -164.905 -8.27358 -164.511 -6.45506 -164.117 -4.63709 -163.721 -2.81911 -163.323 -1.00031 -162.923 0.817429 -162.52 2.63479 -162.113 4.45309 -161.703 6.27043 -161.289 8.08747 -160.869 9.90404 -160.443 11.719 -160.011 13.5336 -159.571 15.3491 -159.125 17.1609 -158.668 18.9721 -158.202 20.7836 -157.726 22.5924 -157.238 24.3999 -156.737 26.2053 -156.221 28.0092 -155.691 29.8105 -155.142 31.6098 -154.576 33.4071 -153.988 35.2004 -153.377 36.9913 -152.741 38.7789 -152.077 40.5624 -151.381 42.3421 -150.65 44.117 -149.88 45.8869 -149.066 47.6511 -148.203 49.4096 -147.285 51.1593 -146.303 52.902 -145.249 54.636 -144.114 56.3579 -142.883 58.069 -141.544 59.7651 -140.078 61.4449 -138.463 63.1043 -136.675 64.7408 -134.681 66.3489 -132.443 67.9228 -129.912 69.4542 -127.03 70.9334 -123.726 72.3475 -119.914 73.6799 -115.495 74.9079 -110.359 76.0056 -104.402 76.9387 -97.5481 77.671 -89.7914 78.1646 -81.2456 78.3893 -72.1809 78.3295 -62.9933 77.9898 -54.1006 77.3916 -45.8646 76.5709 -38.48 75.5646 -32.0019 74.4087 -26.4022 73.1343 -21.5818 71.7654 -17.4258 70.3221 -13.8379 68.8197 -10.7205 67.2693 -7.9945 67.6021 -6.63129 67.9147 -5.21908 68.2148 -3.76918 68.5021 -2.28179 68.7752 -0.756201 69.0343 0.806289 69.2768 2.40536 69.506 4.03931 69.7197 5.70738 69.9199 7.40703 70.101 9.13891 70.265 10.8999 70.4121 12.6844 70.5409 14.4961 70.6515 16.3294 70.7434 18.1812 70.8166 20.0483 70.8707 21.9273 70.8951 23.8214 72.6799 23.6049 74.4653 23.3994 76.2498 23.2106 78.0341 23.0423 79.8175 22.9133 81.601 22.8429 83.3845 22.8701 85.1667 23.1187 86.9483 23.9792 88.7257 27.9373 89.4571 -176.82 87.6926 -163.84 85.9119 -162.363 84.1293 -161.94 82.347 -161.841 80.5634 -161.876 78.7796 -161.987 76.9958 -162.139 75.2115 -162.32 73.4266 -162.519 71.6415 -162.733 69.8557 -162.956 68.0694 -163.188 66.2825 -163.426 64.4954 -163.67 62.7075 -163.918 60.9189 -164.171 59.1294 -164.426 57.3397 -164.686 55.5494 -164.948 53.7577 -165.213 51.9659 -165.482 50.1729 -165.752 48.3796 -166.026 46.5855 -166.303 44.7905 -166.582 42.9949 -166.864 41.1985 -167.15 39.4015 -167.437 37.6037 -167.728 35.8057 -168.023 34.0063 -168.32 32.2068 -168.621 30.4067 -168.925 28.6058 -169.233 26.8054 -169.545 25.0035 -169.861 23.2015 -170.181 21.3993 -170.505 19.597 -170.834 17.7946 -171.169 15.9911 -171.507 14.1889 -171.851 12.3864 -172.202 10.5836 -172.558 8.78134 -172.92 6.97928 -173.289 5.17735 -173.665 3.37699 -174.049 1.57702 -174.441 -0.223336 -174.84 -2.02176 -175.249 -3.81909 -175.667 -5.61593 -176.095 -7.41109 -176.534 -9.2035 -176.985 -10.9965 -177.448 -12.7865 -177.924 -14.5743 -178.414 -16.3604 -178.919 -18.1434 -179.44 -19.9239 -179.979 -21.7024 179.465 -23.4763 178.887 -25.2478 178.288 -27.0151 177.665 -28.7771 177.017 -30.5362 176.341 -32.2896 175.634 -34.038 174.895 -35.7795 174.119 -37.5152 173.304 -39.2428 172.446 -40.9627 171.539 -42.6745 170.58 -44.3756 169.563 -45.2753 168.996";
      footprintStub(footprint, "Olci reduced 3");
   }

   @Test
   public void testSlstrNorthPole3()
   {
      String footprint = "84.1277 142.852 84.1263 147.373 84.0989 151.761 84.0233 156.153 83.9248 160.382 83.7929 164.476 83.6313 168.401 83.4412 172.08 83.2302 175.533 82.9914 178.778 82.724 -178.17 82.4538 -175.387 82.1485 -172.77 81.8445 -170.375 81.5224 -168.142 81.1818 -166.052 80.838 -164.146 80.4819 -162.375 80.1231 -160.749 79.752 -159.22 79.3793 -157.766 78.9951 -156.443 78.6027 -155.203 78.2089 -154.065 77.8156 -152.964 77.4188 -151.942 77.0136 -150.988 76.6018 -150.118 76.1863 -149.269 75.7796 -148.451 75.6165 -148.151 76.5042 -137.649 76.9149 -125.924 76.784 -113.953 76.1265 -102.655 76.289 -102.424 76.7197 -101.773 77.1529 -101.029 77.5729 -100.305 78.0049 -99.502 78.4217 -98.6167 78.8383 -97.7106 79.2525 -96.6983 79.6665 -95.5969 80.0732 -94.4124 80.479 -93.1847 80.8779 -91.7958 81.2663 -90.3082 81.6515 -88.6703 82.0349 -86.83 82.4051 -84.8479 82.7655 -82.6752 83.1127 -80.2472 83.4526 -77.669 83.7683 -74.6714 84.0689 -71.5144 84.3525 -67.8764 84.6131 -64.0779 84.8404 -59.6618 85.0391 -54.9981 85.2027 -49.9836 85.3274 -44.6606 85.4139 -39.1857 85.448 -33.3839 85.4403 -27.6338 88.0334 -22.0567 89.2295 119.418 86.6881 140.534 84.1277 142.852";
      footprintStub(footprint, "SLSTR north 3");
   }

   @Test
   public void testSynVgp()
   {
      String footprint = "86.4459 167.322 85.4266 166.749 84.4074 166.324 83.3878 165.98 82.3673 165.714 81.3475 165.458 80.3278 165.216 79.3079 165 78.2874 164.799 77.2669 164.606 76.2464 164.418 75.2262 164.234 74.2055 164.054 73.1844 163.88 72.1634 163.708 71.1423 163.537 70.1211 163.368 69.0992 163.213 68.0775 163.037 67.0553 162.886 66.0331 162.728 65.0103 162.58 63.9884 162.404 62.9662 162.228 61.9429 162.069 60.9201 161.896 59.8961 161.747 58.8726 161.583 57.8492 161.415 56.825 161.257 55.7997 161.115 54.7759 160.937 53.7518 160.764 52.7267 160.603 51.7014 160.44 50.676 160.277 49.6502 160.114 48.6242 159.95 47.5979 159.786 46.5713 159.621 45.5445 159.456 44.5175 159.29 43.4903 159.123 42.4629 158.956 41.4351 158.788 40.4071 158.62 39.379 158.451 38.3508 158.28 37.3223 158.108 36.293 157.938 35.2638 157.766 34.2349 157.591 33.2059 157.416 32.1762 157.241 31.1463 157.064 30.1163 156.887 29.0861 156.708 28.0556 156.529 27.0252 156.348 25.9949 156.165 24.9644 155.982 23.9336 155.797 22.9026 155.61 21.8717 155.422 20.8407 155.234 19.8094 155.044 18.7783 154.852 17.7473 154.658 16.7163 154.462 15.6853 154.265 14.6543 154.066 13.6232 153.866 12.5921 153.663 11.561 153.459 10.5299 153.253 9.49903 153.045 8.46865 152.834 7.43809 152.621 6.40754 152.407 5.37745 152.189 4.34764 151.97 3.31786 151.748 2.28822 151.523 1.25909 151.295 0.230229 151.064 -0.798349 150.831 -1.82664 150.596 -2.85489 150.357 -3.88241 150.114 -4.90944 149.868 -5.93705 149.624 -6.96213 149.366 -7.9876 149.109 -9.01273 148.849 -10.0377 148.586 -11.0619 148.318 -12.0847 148.045 -13.1072 147.767 -14.1298 147.486 -15.1511 147.2 -16.171 146.907 -17.1906 146.61 -18.2099 146.309 -19.2291 146.007 -20.2446 145.691 -21.2603 145.37 -22.2752 145.042 -23.2898 144.709 -24.3027 144.37 -25.3138 144.022 -26.323 143.666 -27.3317 143.302 -28.339 142.928 -29.345 142.548 -30.3495 142.159 -31.3525 141.76 -32.3531 141.348 -33.352 140.927 -34.3486 140.494 -35.3436 140.051 -36.3369 139.593 -37.3285 139.124 -38.3168 138.639 -39.3022 138.139 -40.286 137.626 -41.2669 137.096 -42.2445 136.547 -43.219 135.98 -44.191 135.394 -45.159 134.788 -45.499 134.569 -45.9968 136.19 -46.395 137.567 -46.7225 138.762 -46.9592 139.667 -47.2049 140.642 -47.4226 141.543 -47.6171 142.381 -47.7622 143.044 -47.9281 143.81 -48.0805 144.553 -48.2232 145.275 -48.3439 145.878 -48.4782 146.595 -48.6108 147.317 -48.7177 147.943 -48.8432 148.697 -48.9685 149.485 -49.0937 150.313 -49.1555 150.739 -48.1334 151.073 -47.1078 151.397 -46.082 151.715 -45.0558 152.025 -44.0284 152.328 -43 152.624 -41.972 152.914 -40.9435 153.2 -39.9138 153.48 -38.8835 153.754 -37.8535 154.025 -36.8225 154.291 -35.7904 154.553 -34.7585 154.812 -33.7265 155.068 -32.6938 155.32 -31.6604 155.569 -30.6267 155.816 -29.5929 156.06 -28.559 156.302 -27.5243 156.543 -26.4885 156.78 -25.4525 157.016 -24.4168 157.25 -23.3809 157.483 -22.3447 157.715 -21.3082 157.946 -20.2711 158.175 -19.2341 158.403 -18.1973 158.63 -17.1598 158.857 -16.1215 159.083 -15.0831 159.308 -14.0457 159.534 -13.0069 159.758 -11.968 159.983 -10.9293 160.207 -9.89069 160.432 -8.85178 160.656 -7.81293 160.881 -6.774 161.106 -5.73492 161.332 -4.69553 161.558 -3.65612 161.784 -2.61687 162.011 -1.57767 162.239 -0.538695 162.468 0.500307 162.698 1.53953 162.929 2.57853 163.161 3.61737 163.394 4.65634 163.629 5.69531 163.865 6.7335 164.103 7.77177 164.342 8.81038 164.584 9.84852 164.827 10.8863 165.072 11.9238 165.32 12.9611 165.57 13.998 165.823 15.0344 166.078 16.0706 166.336 17.1066 166.597 18.1425 166.861 19.1779 167.129 20.2127 167.4 21.247 167.675 22.2808 167.953 23.3139 168.236 24.3464 168.523 25.3785 168.815 26.4103 169.112 27.4417 169.413 28.472 169.72 29.5017 170.033 30.5307 170.352 31.5584 170.677 32.5851 171.009 33.6115 171.348 34.6375 171.695 35.6622 172.049 36.6853 172.413 37.7076 172.785 38.7287 173.166 39.7489 173.558 40.7676 173.961 41.7849 174.375 42.8008 174.802 43.8154 175.241 44.8284 175.694 45.8395 176.162 46.8487 176.647 47.856 177.148 48.8613 177.667 49.8644 178.207 50.8652 178.767 51.8634 179.35 52.8586 179.957 53.8508 -179.408 54.8398 -178.745 55.8256 -178.051 56.8076 -177.324 57.7857 -176.559 58.7591 -175.754 59.7279 -174.906 60.6911 -174.01 61.648 -173.062 62.5986 -172.056 63.5425 -170.987 64.4785 -169.847 65.4056 -168.631 66.3228 -167.33 67.2288 -165.934 68.1228 -164.435 69.0033 -162.82 69.8671 -161.07 70.7135 -159.178 71.5392 -157.126 72.3424 -154.896 73.1196 -152.469 73.8667 -149.823 74.5792 -146.939 75.2514 -143.794 75.8787 -140.371 76.4567 -136.651 76.9756 -132.629 77.4281 -128.308 77.8089 -123.698 77.9245 -122.01 78.4621 -122.845 78.9733 -123.719 79.461 -124.634 79.8623 -125.453 80.3211 -126.482 80.775 -127.608 81.2242 -128.847 81.6039 -129.999 82.0592 -131.548 82.5242 -133.35 82.9989 -135.473 83.4059 -137.618 83.9156 -140.751 84.4455 -144.794 84.9062 -149.272 85.4541 -156.457 85.9743 -167.003 86.3634 177.335 86.4459 167.322";
      footprintStub(footprint, "VGP");
   }

   @Test
   public void testBasicBigFootprint()
   {
      String footprint = "78.76779175784321 -126.9140625 -81.72318761821154 -124.8046875 -81.72318761821154 23.5234375 -81.72318761821154 151.5234375 77.91566898632584 143.0859375 81.72318761821154 -23.5546875 78.76779175784321 -126.9140625";
      footprintStub(footprint, "Big Footprint");
   }

   @Test
   public void testBasicBigFootprint2()
   {
      String footprint = "79.93591824625466 123.046875 79.93591824625466 -99.140625 -75.49715731893083 -99.140625 -75.49715731893083 123.046875 79.93591824625466 123.046875";
      footprintStub(footprint, "Big Footprint 2");
   }

   private void footprintStub(String footprint, String title)
   {
      footprintStub(footprint, title, "POLYGON");
   }

   private void footprintStub(String footprint, String title, String type)
   {
      String extractedFootprint = points2JTS(footprint, type);
      LOGGER.info("Extracted footprint {}: {}", title, extractedFootprint);

      String parsedFootprint = WKTFootprintParser.reformatWKTFootprint(extractedFootprint);
      // String parsedFootprint = parseFootprint(extractedFootprint);
      LOGGER.info("Parsed footprint {}: {}", title, parsedFootprint);
      Assert.assertTrue(parsedFootprint != null, "Footprint is null, validation failed");
      Assert.assertTrue(parsedFootprint.contains(type), "Unexpected geometry found");
      Assert.assertTrue(validJts(parsedFootprint), "JTS not valid");
      Assert.assertTrue(validateWkt(parsedFootprint));
   }

   private static boolean validateWkt(String wkt)
   {
      Boolean isPolygon = wkt.contains("POLYGON");
      SpatialReference wgs84 = SpatialReference.create(4326);
      if (isPolygon)
      {
         Polygon polygon = (Polygon) OperatorImportFromWkt.local()
               .execute(WktImportFlags.wktImportDefaults, Geometry.Type.Polygon, wkt, null);
         return OperatorSimplifyOGC.local().isSimpleOGC(polygon, wgs84, true, null, null);
      }
      Polyline polyline = (Polyline) OperatorImportFromWkt.local()
            .execute(WktImportFlags.wktImportDefaults, Geometry.Type.Polyline, wkt, null);
      return OperatorSimplifyOGC.local().isSimpleOGC(polyline, wgs84, true, null, null);
   }

   private boolean validJts(String wkt)
   {
      try
      {
         WKTReader wktReader = new JtsWKTReader(JtsSpatialContext.GEO, new JtsSpatialContextFactory());
         Shape geo = wktReader.read(wkt);
         Assert.assertNotNull(geo);
         if (((ShapeCollection) geo).getShapes().size() > 2)
         {
            for (Object s: ((ShapeCollection) geo).getShapes())
            {
               LOGGER.warn(s.toString());
            }
            return false;
         }
         return true;
      }
      catch (IOException | java.text.ParseException e)
      {
         LOGGER.error(e.getMessage());
         return false;
      }
   }
}
